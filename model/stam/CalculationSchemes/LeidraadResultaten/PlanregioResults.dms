//////////////////////////////////////////////////////////////////////////////////////////
//                                                                                      //
//                   (C) VESTA 2020 - Planbureau voor de Leefomgeving                   //
//                                                                                      //
//////////////////////////////////////////////////////////////////////////////////////////

container PlanregioResults
{
	attribute<nrWoning> nrWEQ    (Planregio) :=
		  sum(bebouwing/BestaandeWoning/nrAansluitingen / 1.0[nrAsl / nrWoning], bebouwing/BestaandeWoning/Planregio_rel)
		+ sum(bebouwing/BestaandeUtil/Oppervlakte / 130[m2 / nrWoning], bebouwing/BestaandeUtil/Planregio_rel);
	attribute<ratio>      R_StadV  (Planregio) := Invoer/RuimtelijkeData/StudieGebied/buurt/R_StadV;
	attribute<ratio>      R_AardG  (Planregio) := 1D - R_StadV;
	attribute<string>     IsWater  (Planregio) := Invoer/RuimtelijkeData/StudieGebied/buurt/IsWater;
	parameter<Float64>    KlimaatneutraalGasFactor := TussenResultaten/Voorkeuren/KlimaatneutraalGasFactor;

	container Hulpvariabelen
	{
		container Checks
		{
			attribute<bool> s3GeenLT (PlanRegio) :=
				   not(isStap0)
				&& not(isReferentie)
				&& (Variantcode == 's3a' || Variantcode == 's3b' || Variantcode == 's3c' || Variantcode == 's3d' || Variantcode == 's3e' || Variantcode == 's3f' || Variantcode == 's3g' || Variantcode == 's3h')
				&& Aansluitingen/Table/A04_Aansl_LT < 1[nrAsl];
			
			attribute<bool> s2GeenMT (PlanRegio) := 
				   not(isStap0) 
				&& not(isReferentie) 
				&& (Variantcode == 's2a' || Variantcode == 's2d') 
				&& (Aansluitingen/Table/A01_Aansl_aardgas + Aansluitingen/Table/A02_Aansl_eWP + Aansluitingen/Table/A04_Aansl_LT + Aansluitingen/Table/A05_Aansl_hWP_HG + Aansluitingen/Table/A06_Aansl_HR_HG) > 0[nrAsl];
				
			attribute<bool> NegatiefCO2 (PlanRegio) := NationaleKosten/TotaalUitstoot/Delta_CO2 < 0.0[ton_yr];
				
		}
		
		unit<uint32> table := PlanRegio
		{
			attribute<string>   BU_CODE := Statisch/table/I01_buurtcode;
			attribute<nrWoning> nrWEQ   := .../nrWEQ;
			attribute<ratio>    R_StadV := .../R_StadV;
			attribute<GJ_yr>    VraagH2 := StateNaAllocatie/Totaal/Verbruik/V_H2;
			attribute<GJ_yr>    VraagKG := 
				(Statisch/IsUitgesloten || nrWEQ == 0[nrWoning])
					? 0[GJ_yr] 
					: MakeDefined(
							  R_AardG * sum(Allocatie/BestaandeWoning/metervraag/Aardgas, bebouwing/BestaandeWoning/PlanRegio_rel)
							+ R_AardG * sum(Allocatie/BestaandeUtil/metervraag/Aardgas  , bebouwing/BestaandeUtil/PlanRegio_rel)
						,0[GJ_yr]
					 ) * KlimaatneutraalGasFactor;
			attribute<string> Uitgesloten := string(Statisch/IsUitgesloten);
			attribute<string> IsOngeldig    := string(Checks/s3GeenLT || Checks/s2GeenMT || Statisch/IsUitgesloten);

			attribute<string> MT_nr := =(Variantcode == 's2a' || Variantcode == 's2d') 
				? 'TussenResultaten/GebiedsAllocatie/RestWarmte/results/RestWarmte/bron_naam' 
				: 'const(Variantcode, Planregio)'; //lijst nr uit csv-bestand MT

			attribute<string> LT_nr := =(Variantcode == 's3a' || Variantcode == 's3b' || Variantcode == 's3f') 
				? 'TussenResultaten/AllocatieResultaten/AfnamegebiedenPerPlanregioReport' 
				: 'const(Variantcode, Planregio)'; //lijst nr uit csv-bestand LT
				
				
			attribute<float64> AantalA :=
				  sum(float64(Allocatie/BestaandeUtil/BO/Schillabel_rel
				  		== Classifications/schillabel/V/A), Allocatie/BestaandeUtil/BO/Planregio_rel)
				+ sum(float64(Allocatie/BestaandeWoning/BO/Schillabel_rel
						== Classifications/schillabel/V/A), Allocatie/BestaandeWoning/BO/Planregio_rel);
			attribute<float64> AantalB :=
				  sum(float64(Allocatie/BestaandeUtil/BO/Schillabel_rel
				  		== Classifications/schillabel/V/B), Allocatie/BestaandeUtil/BO/Planregio_rel)
				+ sum(float64(Allocatie/BestaandeWoning/BO/Schillabel_rel
						== Classifications/schillabel/V/B), Allocatie/BestaandeWoning/BO/Planregio_rel);
			attribute<float64> AantalC :=
				  sum(float64(Allocatie/BestaandeUtil/BO/Schillabel_rel
				  		== Classifications/schillabel/V/C), Allocatie/BestaandeUtil/BO/Planregio_rel)
				+ sum(float64(Allocatie/BestaandeWoning/BO/Schillabel_rel
						== Classifications/schillabel/V/C), Allocatie/BestaandeWoning/BO/Planregio_rel);
			attribute<float64> AantalD :=
				  sum(float64(Allocatie/BestaandeUtil/BO/Schillabel_rel
				  		== Classifications/schillabel/V/D), Allocatie/BestaandeUtil/BO/Planregio_rel)
				+ sum(float64(Allocatie/BestaandeWoning/BO/Schillabel_rel
						== Classifications/schillabel/V/D), Allocatie/BestaandeWoning/BO/Planregio_rel);
			attribute<float64> AantalE :=
				  sum(float64(Allocatie/BestaandeUtil/BO/Schillabel_rel
				  		== Classifications/schillabel/V/E), Allocatie/BestaandeUtil/BO/Planregio_rel)
				+ sum(float64(Allocatie/BestaandeWoning/BO/Schillabel_rel
						== Classifications/schillabel/V/E), Allocatie/BestaandeWoning/BO/Planregio_rel);
			attribute<float64> AantalF :=
				  sum(float64(Allocatie/BestaandeUtil/BO/Schillabel_rel
				  		== Classifications/schillabel/V/F), Allocatie/BestaandeUtil/BO/Planregio_rel)
				+ sum(float64(Allocatie/BestaandeWoning/BO/Schillabel_rel
						== Classifications/schillabel/V/F), Allocatie/BestaandeWoning/BO/Planregio_rel);
			attribute<float64> AantalG :=
				  sum(float64(Allocatie/BestaandeUtil/BO/Schillabel_rel
				  		== Classifications/schillabel/V/G), Allocatie/BestaandeUtil/BO/Planregio_rel)
				+ sum(float64(Allocatie/BestaandeWoning/BO/Schillabel_rel
						== Classifications/schillabel/V/G), Allocatie/BestaandeWoning/BO/Planregio_rel);
			attribute<float64> AantalN :=
				  sum(float64(Allocatie/BestaandeUtil/BO/Schillabel_rel
				  		== Classifications/schillabel/V/N), Allocatie/BestaandeUtil/BO/Planregio_rel)
				+ sum(float64(Allocatie/BestaandeWoning/BO/Schillabel_rel
						== Classifications/schillabel/V/N), Allocatie/BestaandeWoning/BO/Planregio_rel);
		}

		parameter<string> OutputFolder := '%localDataProjDir%/Results/' + Expand( . , '%configName%') + '/'+ 'Leidraad';
		unit<uint32>      variable     := SubItem_PropValues(table,'name');
		container         export_csv   := Rapportage/WriteTable32ToCSV(table, AsList(variable/name, ';'), OutputFolder+'/Hulpvariabelen.csv');
	}
	
	container GevoeligheidsAnalyse
	{
		unit<uint32> table := PlanRegio
		{
			attribute<string> BU_CODE := Statisch/table/I01_buurtcode;
			
			attribute<string>  G01_Toekenning_klimaatneutraal_gas_1_5 := const("dummyvar",PlanRegio);
			attribute<string>  G02_Toekenning_klimaatneutraal_gas_1_0 := const("dummyvar",PlanRegio);
			attribute<Eur_ton> G03_Nat_meerkost_energiekosten_laag    := =Invoer/G03_aan ? 'Hoofdindicatoren/Table/H17_Nat_meerkost_CO2' : 'const((0/0)[Eur_ton],PlanRegio)';
			attribute<Eur_ton> G04_Nat_meerkost_energiekosten_hoog    := =Invoer/G04_aan ? 'Hoofdindicatoren/Table/H17_Nat_meerkost_CO2' : 'const((0/0)[Eur_ton],PlanRegio)';
			attribute<Eur_ton> G05_Nat_meerkost_energiebesparing_opt  := =Invoer/G05_aan ? 'Hoofdindicatoren/Table/H17_Nat_meerkost_CO2' : 'const((0/0)[Eur_ton],PlanRegio)';
		}
		parameter<string> RefExpr      := isStap0 ? 'Ref_2023_' : isReferentie ? 'Ref_2030_' : '%configName%/';
		parameter<string> OutputFolder := '%localDataProjDir%/Results/' + Expand( . , RefExpr) + ''+ '';
		unit<uint32>      variable     := SubItem_PropValues(table,'name');
		container         export_csv   := Rapportage/WriteTable32ToCSV(table, AsList(variable/name, ';'), OutputFolder+'GevoeligheidsAnalyse.csv');
	}

	//Statische indicatoren per buurt. Met Statisch wordt bedoeld dat resultaten niet verschillen per run.
	container Statisch
	{
		attribute<bool> IsUitgesloten (Planregio) := Invoer/RuimtelijkeData/leidraad_oktober_2019/IsUitgesloten;

		unit<uint32>  table := PlanRegio
		{
			attribute<string>   BU_CODE                := I01_buurtcode;
			attribute<string>   I01_buurtcode          := Invoer/RuimtelijkeData/StudieGebied/buurt/BU_CODE;
			attribute<string>   I02_buurtnaam          := IsUitgesloten ? 'UITGESLOTEN' : replace(Invoer/RuimtelijkeData/StudieGebied/buurt/BU_NAAM, ',' , '');
			attribute<string>   I03_wijkcode           := Invoer/RuimtelijkeData/StudieGebied/buurt/WK_CODE;
			attribute<string>   I04_wijknaam           := IsUitgesloten ? 'UITGESLOTEN' : replace(Invoer/RuimtelijkeData/StudieGebied/buurt/WK_NAAM, ',' , '');
			attribute<string>   I05_gemeentecode       := Invoer/RuimtelijkeData/StudieGebied/buurt/GM_CODE;
			attribute<string>   I06_gemeentenaam       := IsUitgesloten ? 'UITGESLOTEN' : replace(Invoer/RuimtelijkeData/StudieGebied/buurt/GM_NAAM, ',' , '');
			attribute<string>   I07_energieregionaam   := IsUitgesloten ? 'UITGESLOTEN' : replace(Invoer/RuimtelijkeData/StudieGebied/buurt/ER_NAAM, ',' , '');
			attribute<string>   I08_provincienaam      := IsUitgesloten ? 'UITGESLOTEN' : replace(Invoer/RuimtelijkeData/StudieGebied/buurt/PROV_NAAM, ',' , '');
			attribute<nrAsl>    I09_aantal_woningen    := IsUitgesloten ? 0[nrAsl]      : roundUp(sum(bebouwing/BestaandeWoning/nrAansluitingen, bebouwing/BestaandeWoning/PlanRegio_rel))[nrAsl];
			attribute<nrAsl>    I10_aantal_utiliteit   := IsUitgesloten ? 0[nrAsl]      : roundUp(sum(bebouwing/BestaandeUtil/nrAansluitingen  , bebouwing/BestaandeUtil/PlanRegio_rel))[nrAsl];
			attribute<nrWoning> I11_woningequivalenten := IsUitgesloten ? 0[nrwoning]   : roundUp(nrWEQ)[nrWoning]; //130m2 utiliteit = 1 WEQ

			attribute<ton_yr>   I12_CO2_startjaar      :=
				round(
					(Statisch/IsUitgesloten || nrWEQ == 0[nrWoning]) ? 0[ton_yr] 
					: MakeDefined( StartJaar/OrigKosten/Orig_CO2_ton, 0[ton_yr])
				)[ton_yr];					
					
			attribute<string>   I13_Uitgesloten        := string(IsUitgesloten);
			attribute<nrAsl>    I14_WEQ_utiliteit      := IsUitgesloten ? 0[nrAsl]      : roundUp(sum(bebouwing/BestaandeUtil/Oppervlakte / 130[m2]  , bebouwing/BestaandeUtil/PlanRegio_rel))[nrAsl];

			attribute<nrWoning> I15_Woningen_met_afgemeld_label 		:= IsUitgesloten ? 0[nrwoning] : roundUp(sum(float64(IsDefined(Invoer/RuimtelijkeData/Bebouwing/impl/BestaandeWoning/SchilLabel_rel)), BeginSituatie/StartingStateComponenten/BestaandeWoning/Results/Planregio_rel))[nrWoning];
			attribute<nrAsl> 	I16_WEQ_Utiliteit_met_afgemeld_label 	:= IsUitgesloten ? 0[nrAsl] : roundUp(sum(float64(IsDefined(Invoer/RuimtelijkeData/Bebouwing/impl/BestaandeUtil/SchilLabel_rel)) * Invoer/RuimtelijkeData/BAG/vbo_utiliteit_studiegebied/oppervlakte / 130[m2], BeginSituatie/StartingStateComponenten/BestaandeUtil/Results/Planregio_rel))[nrAsl];

			attribute<nrWoning> I17_Woningen_zonder_afgemeld_label 	:= IsUitgesloten ? 0[nrwoning] : roundUp(sum(float64(BeginSituatie/StartingStateComponenten/BestaandeWoning/Results/SchilLabel_rel == Classifications/schillabel/V/N), BeginSituatie/StartingStateComponenten/BestaandeWoning/Results/Planregio_rel))[nrWoning];
			
			attribute<nrAsl> 	I18_WEQ_Utiliteit_Defaultlabel_A 	:= IsUitgesloten ? 0[nrAsl] : roundUp(sum(float64(BeginSituatie/StartingStateComponenten/BestaandeUtil/Results/SchilLabel_rel == Classifications/schillabel/V/A && not(IsDefined(Invoer/RuimtelijkeData/Bebouwing/impl/BestaandeUtil/SchilLabel_rel))) * Invoer/RuimtelijkeData/BAG/vbo_utiliteit_studiegebied/oppervlakte / 130[m2], BeginSituatie/StartingStateComponenten/BestaandeUtil/Results/Planregio_rel))[nrAsl]; //130m2 utiliteit = 1 WEQ
			attribute<nrAsl> 	I19_WEQ_Utiliteit_Defaultlabel_B 	:= IsUitgesloten ? 0[nrAsl] : roundUp(sum(float64(BeginSituatie/StartingStateComponenten/BestaandeUtil/Results/SchilLabel_rel == Classifications/schillabel/V/B && not(IsDefined(Invoer/RuimtelijkeData/Bebouwing/impl/BestaandeUtil/SchilLabel_rel))) * Invoer/RuimtelijkeData/BAG/vbo_utiliteit_studiegebied/oppervlakte / 130[m2], BeginSituatie/StartingStateComponenten/BestaandeUtil/Results/Planregio_rel))[nrAsl]; //130m2 utiliteit = 1 WEQ
			attribute<nrAsl> 	I20_WEQ_Utiliteit_Defaultlabel_C 	:= IsUitgesloten ? 0[nrAsl] : roundUp(sum(float64(BeginSituatie/StartingStateComponenten/BestaandeUtil/Results/SchilLabel_rel == Classifications/schillabel/V/C && not(IsDefined(Invoer/RuimtelijkeData/Bebouwing/impl/BestaandeUtil/SchilLabel_rel))) * Invoer/RuimtelijkeData/BAG/vbo_utiliteit_studiegebied/oppervlakte / 130[m2], BeginSituatie/StartingStateComponenten/BestaandeUtil/Results/Planregio_rel))[nrAsl]; //130m2 utiliteit = 1 WEQ
			attribute<nrAsl> 	I21_WEQ_Utiliteit_Defaultlabel_D 	:= IsUitgesloten ? 0[nrAsl] : roundUp(sum(float64(BeginSituatie/StartingStateComponenten/BestaandeUtil/Results/SchilLabel_rel == Classifications/schillabel/V/D && not(IsDefined(Invoer/RuimtelijkeData/Bebouwing/impl/BestaandeUtil/SchilLabel_rel))) * Invoer/RuimtelijkeData/BAG/vbo_utiliteit_studiegebied/oppervlakte / 130[m2], BeginSituatie/StartingStateComponenten/BestaandeUtil/Results/Planregio_rel))[nrAsl]; //130m2 utiliteit = 1 WEQ
			attribute<nrAsl> 	I22_WEQ_Utiliteit_Defaultlabel_E 	:= IsUitgesloten ? 0[nrAsl] : roundUp(sum(float64(BeginSituatie/StartingStateComponenten/BestaandeUtil/Results/SchilLabel_rel == Classifications/schillabel/V/E && not(IsDefined(Invoer/RuimtelijkeData/Bebouwing/impl/BestaandeUtil/SchilLabel_rel))) * Invoer/RuimtelijkeData/BAG/vbo_utiliteit_studiegebied/oppervlakte / 130[m2], BeginSituatie/StartingStateComponenten/BestaandeUtil/Results/Planregio_rel))[nrAsl]; //130m2 utiliteit = 1 WEQ
			attribute<nrAsl> 	I23_WEQ_Utiliteit_Defaultlabel_F 	:= IsUitgesloten ? 0[nrAsl] : roundUp(sum(float64(BeginSituatie/StartingStateComponenten/BestaandeUtil/Results/SchilLabel_rel == Classifications/schillabel/V/F && not(IsDefined(Invoer/RuimtelijkeData/Bebouwing/impl/BestaandeUtil/SchilLabel_rel))) * Invoer/RuimtelijkeData/BAG/vbo_utiliteit_studiegebied/oppervlakte / 130[m2], BeginSituatie/StartingStateComponenten/BestaandeUtil/Results/Planregio_rel))[nrAsl]; //130m2 utiliteit = 1 WEQ
			attribute<nrAsl> 	I24_WEQ_Utiliteit_Defaultlabel_G 	:= IsUitgesloten ? 0[nrAsl] : roundUp(sum(float64(BeginSituatie/StartingStateComponenten/BestaandeUtil/Results/SchilLabel_rel == Classifications/schillabel/V/G && not(IsDefined(Invoer/RuimtelijkeData/Bebouwing/impl/BestaandeUtil/SchilLabel_rel))) * Invoer/RuimtelijkeData/BAG/vbo_utiliteit_studiegebied/oppervlakte / 130[m2], BeginSituatie/StartingStateComponenten/BestaandeUtil/Results/Planregio_rel))[nrAsl]; //130m2 utiliteit = 1 WEQ
		
			attribute<nrAsl>    I25_aantal_woningen_na2019 := IsUitgesloten ? 0[nrAsl]   : sum(float64(
						Invoer/RuimtelijkeData/BAG/import/vbo/gebruiksdoelen/woon
					&& Invoer/RuimtelijkeData/StudieGebied/selected_per_gemeente[Invoer/RuimtelijkeData/BAG/import/vbo/gemeente_rel]
					&& IsDefined(Invoer/RuimtelijkeData/BAG/import/vbo/pand_rel)
					&& Invoer/RuimtelijkeData/BAG/import/vbo/oppervlak_filters/wonen >=  10[Units/m2]
					&& Invoer/RuimtelijkeData/BAG/import/vbo/oppervlak_filters/wonen < 1000[Units/m2]
					&& Invoer/RuimtelijkeData/BAG/import/vbo/pand_rel -> bouwjaar_gecorrigeerd >= 2020[yr]
					) * 1.0[nrAsl],  point_in_polygon( Invoer/RuimtelijkeData/BAG/import/vbo/geometry , Invoer/RuimtelijkeData/StudieGebied/buurt/geometry ));
		}

		parameter<string> OutputFolder := '%localDataProjDir%/Results' + Expand( . , '') + ''+ '';

		unit<uint32> variable := SubItem_PropValues(table,'name');

		container export_csv := Rapportage/WriteTable32ToCSV(table, AsList(variable/name, ';'), OutputFolder+'/Statisch.csv');

		unit<uint32> table_vergelijking := table, StorageName = "=FolderInfo/OutputFolder+'/Statisch.fss'"
		{
			attribute<string>   BU_CODE                := I01_buurtcode;
			attribute<nrWoning> I11_woningequivalenten := IsUitgesloten ? 0[nrWoning] : nrWEQ; // voor de vergelijking, daarvoor GEEN integers wegschrijven.
		}
	}

	container Gebouwvoorraad_export
	{
		attribute<bool> IsUitgesloten (Planregio) := Invoer/RuimtelijkeData/leidraad_oktober_2019/IsUitgesloten;

		container Class
		{
			unit<uint32> WB := combine(classifications/WoningtypeBestaand, classifications/BouwjaarWoningBestaand)
			{
				attribute<string> name := classifications/WoningtypeBestaand/name[first_rel] + '_' + classifications/BouwjaarWoningBestaand/name[second_rel];
			}
			unit<uint32> WS := combine(classifications/WoningtypeBestaand, classifications/schillabel)
			{
				attribute<string> name := classifications/WoningtypeBestaand/name[first_rel] + '_' + classifications/schillabel/name[second_rel];
			}
			unit<uint32> UB := combine(classifications/UtilTypeBestaand, classifications/BouwjaarUtilBestaand)
			{
				attribute<string> name := classifications/UtilTypeBestaand/name[first_rel] + '_' + classifications/BouwjaarUtilBestaand/name[second_rel];
			}
		}

		container tellingen
		{
			container woningtype_bouwjaarklasse := for_each_ind(
			'nedv'
			, Class/WB/name
			,'sum(float64(Invoer/RuimtelijkeData/BAG/vbo_woonfunctie_studiegebied/WoningtypeBestaand_rel == rjoin("'+Class/WB/name+'",Class/WB/name,class/WB/first_rel))
				* float64(Invoer/RuimtelijkeData/BAG/vbo_woonfunctie_studiegebied/BouwjaarWoningBestaand_rel == rjoin("'+Class/WB/name+'",Class/WB/name,class/WB/second_rel)), /Invoer/RuimtelijkeData/BAG/vbo_woonfunctie_studiegebied/buurt_rel)'
			, Planregio
			, float64);
			
			container woningtype_energielabel := for_each_ind(
			'nedv'
			, Class/WS/name
			,'sum(float64(Invoer/RuimtelijkeData/BAG/vbo_woonfunctie_studiegebied/WoningtypeBestaand_rel == rjoin("'+Class/WS/name+'",Class/WS/name,class/WS/first_rel))
				* float64(BeginSituatie/StartingStateComponenten/BestaandeWoning/Results/SchilLabel_rel == rjoin("'+Class/WS/name+'",Class/WS/name,class/WS/second_rel)), /Invoer/RuimtelijkeData/BAG/vbo_woonfunctie_studiegebied/buurt_rel)'
			, Planregio
			, float64);
			
			container utiltype_bouwjaarklasse := for_each_ind(
			'nedv'
			, Class/UB/name
			,'sum(float64(Invoer/RuimtelijkeData/BAG/vbo_utiliteit_studiegebied/gebruiksdoel == rjoin("'+Class/UB/name+'",Class/UB/name,class/UB/first_rel))
				* float64(Invoer/RuimtelijkeData/BAG/vbo_utiliteit_studiegebied/BouwjaarUtilBestaand_rel == rjoin("'+Class/UB/name+'",Class/UB/name,class/UB/second_rel))
				* Invoer/RuimtelijkeData/BAG/vbo_utiliteit_studiegebied/oppervlakte, /Invoer/RuimtelijkeData/BAG/vbo_utiliteit_studiegebied/buurt_rel)'
			, Planregio
			, m2);
		}
		
		unit<uint32>  Table := PlanRegio
		{
			attribute<string>   BU_CODE                	:= I01_buurtcode;
			attribute<string>   I01_buurtcode          	:= Invoer/RuimtelijkeData/StudieGebied/buurt/BU_CODE;
			attribute<string>   I02_buurtnaam          	:= IsUitgesloten ? 'UITGESLOTEN' : replace(Invoer/RuimtelijkeData/StudieGebied/buurt/BU_NAAM, ',' , '');
			attribute<string>   I05_gemeentecode       	:= Invoer/RuimtelijkeData/StudieGebied/buurt/GM_CODE;
			attribute<string>   I06_gemeentenaam       	:= IsUitgesloten ? 'UITGESLOTEN' : replace(Invoer/RuimtelijkeData/StudieGebied/buurt/GM_NAAM, ',' , '');
			attribute<string>   I08_provincienaam      	:= IsUitgesloten ? 'UITGESLOTEN' : replace(Invoer/RuimtelijkeData/StudieGebied/buurt/PROV_NAAM, ',' , '');
			
			attribute<nrAsl> 	vrijstaand_v1930		:= IsUitgesloten ? 0[nrAsl] : tellingen/woningtype_bouwjaarklasse/vrijstaand_v1930[nrAsl];
			attribute<nrAsl> 	vrijstaand_v1946		:= IsUitgesloten ? 0[nrAsl] : tellingen/woningtype_bouwjaarklasse/vrijstaand_v1946[nrAsl];
			attribute<nrAsl> 	vrijstaand_v1965		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/vrijstaand_v1965[nrAsl];
			attribute<nrAsl> 	vrijstaand_v1975		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/vrijstaand_v1975[nrAsl];
			attribute<nrAsl> 	vrijstaand_v1992		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/vrijstaand_v1992[nrAsl];
			attribute<nrAsl> 	vrijstaand_v1996		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/vrijstaand_v1996[nrAsl];
			attribute<nrAsl> 	vrijstaand_v2000		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/vrijstaand_v2000[nrAsl];
			attribute<nrAsl> 	vrijstaand_v2006		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/vrijstaand_v2006[nrAsl];
			attribute<nrAsl> 	vrijstaand_v2011		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/vrijstaand_v2011[nrAsl];
			attribute<nrAsl> 	vrijstaand_v2014		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/vrijstaand_v2014[nrAsl];
			attribute<nrAsl> 	vrijstaand_v2020		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/vrijstaand_v2020[nrAsl];
			
			attribute<nrAsl> 	twee_onder_1_kap_v1930		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/twee_onder_1_kap_v1930[nrAsl];
			attribute<nrAsl> 	twee_onder_1_kap_v1946		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/twee_onder_1_kap_v1946[nrAsl];
			attribute<nrAsl> 	twee_onder_1_kap_v1965		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/twee_onder_1_kap_v1965[nrAsl];
			attribute<nrAsl> 	twee_onder_1_kap_v1975		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/twee_onder_1_kap_v1975[nrAsl];
			attribute<nrAsl> 	twee_onder_1_kap_v1992		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/twee_onder_1_kap_v1992[nrAsl];
			attribute<nrAsl> 	twee_onder_1_kap_v1996		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/twee_onder_1_kap_v1996[nrAsl];
			attribute<nrAsl> 	twee_onder_1_kap_v2000		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/twee_onder_1_kap_v2000[nrAsl];
			attribute<nrAsl> 	twee_onder_1_kap_v2006		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/twee_onder_1_kap_v2006[nrAsl];
			attribute<nrAsl> 	twee_onder_1_kap_v2011		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/twee_onder_1_kap_v2011[nrAsl];
			attribute<nrAsl> 	twee_onder_1_kap_v2014		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/twee_onder_1_kap_v2014[nrAsl];
			attribute<nrAsl> 	twee_onder_1_kap_v2020		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/twee_onder_1_kap_v2020[nrAsl];
			
			attribute<nrAsl> 	hoekwoning_v1930		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/hoekwoning_v1930[nrAsl];
			attribute<nrAsl> 	hoekwoning_v1946		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/hoekwoning_v1946[nrAsl];
			attribute<nrAsl> 	hoekwoning_v1965		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/hoekwoning_v1965[nrAsl];
			attribute<nrAsl> 	hoekwoning_v1975		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/hoekwoning_v1975[nrAsl];
			attribute<nrAsl> 	hoekwoning_v1992		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/hoekwoning_v1992[nrAsl];
			attribute<nrAsl> 	hoekwoning_v1996		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/hoekwoning_v1996[nrAsl];
			attribute<nrAsl> 	hoekwoning_v2000		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/hoekwoning_v2000[nrAsl];
			attribute<nrAsl> 	hoekwoning_v2006		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/hoekwoning_v2006[nrAsl];
			attribute<nrAsl> 	hoekwoning_v2011		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/hoekwoning_v2011[nrAsl];
			attribute<nrAsl> 	hoekwoning_v2014		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/hoekwoning_v2014[nrAsl];
			attribute<nrAsl> 	hoekwoning_v2020		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/hoekwoning_v2020[nrAsl];
			
			attribute<nrAsl> 	tussenwoning_v1930		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/tussenwoning_v1930[nrAsl];
			attribute<nrAsl> 	tussenwoning_v1946		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/tussenwoning_v1946[nrAsl];
			attribute<nrAsl> 	tussenwoning_v1965		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/tussenwoning_v1965[nrAsl];
			attribute<nrAsl> 	tussenwoning_v1975		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/tussenwoning_v1975[nrAsl];
			attribute<nrAsl> 	tussenwoning_v1992		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/tussenwoning_v1992[nrAsl];
			attribute<nrAsl> 	tussenwoning_v1996		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/tussenwoning_v1996[nrAsl];
			attribute<nrAsl> 	tussenwoning_v2000		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/tussenwoning_v2000[nrAsl];
			attribute<nrAsl> 	tussenwoning_v2006		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/tussenwoning_v2006[nrAsl];
			attribute<nrAsl> 	tussenwoning_v2011		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/tussenwoning_v2011[nrAsl];
			attribute<nrAsl> 	tussenwoning_v2014		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/tussenwoning_v2014[nrAsl];
			attribute<nrAsl> 	tussenwoning_v2020		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/tussenwoning_v2020[nrAsl];
			
			attribute<nrAsl> 	meergezinspand_laag_midden_v1930		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/meergezinspand_laag_midden_v1930[nrAsl];
			attribute<nrAsl> 	meergezinspand_laag_midden_v1946		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/meergezinspand_laag_midden_v1946[nrAsl];
			attribute<nrAsl> 	meergezinspand_laag_midden_v1965		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/meergezinspand_laag_midden_v1965[nrAsl];
			attribute<nrAsl> 	meergezinspand_laag_midden_v1975		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/meergezinspand_laag_midden_v1975[nrAsl];
			attribute<nrAsl> 	meergezinspand_laag_midden_v1992		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/meergezinspand_laag_midden_v1992[nrAsl];
			attribute<nrAsl> 	meergezinspand_laag_midden_v1996		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/meergezinspand_laag_midden_v1996[nrAsl];
			attribute<nrAsl> 	meergezinspand_laag_midden_v2000		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/meergezinspand_laag_midden_v2000[nrAsl];
			attribute<nrAsl> 	meergezinspand_laag_midden_v2006		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/meergezinspand_laag_midden_v2006[nrAsl];
			attribute<nrAsl> 	meergezinspand_laag_midden_v2011		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/meergezinspand_laag_midden_v2011[nrAsl];
			attribute<nrAsl> 	meergezinspand_laag_midden_v2014		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/meergezinspand_laag_midden_v2014[nrAsl];
			attribute<nrAsl> 	meergezinspand_laag_midden_v2020		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/meergezinspand_laag_midden_v2020[nrAsl];
			
			attribute<nrAsl> 	meergezinspand_hoog_v1930		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/meergezinspand_hoog_v1930[nrAsl];
			attribute<nrAsl> 	meergezinspand_hoog_v1946		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/meergezinspand_hoog_v1946[nrAsl];
			attribute<nrAsl> 	meergezinspand_hoog_v1965		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/meergezinspand_hoog_v1965[nrAsl];
			attribute<nrAsl> 	meergezinspand_hoog_v1975		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/meergezinspand_hoog_v1975[nrAsl];
			attribute<nrAsl> 	meergezinspand_hoog_v1992		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/meergezinspand_hoog_v1992[nrAsl];
			attribute<nrAsl> 	meergezinspand_hoog_v1996		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/meergezinspand_hoog_v1996[nrAsl];
			attribute<nrAsl> 	meergezinspand_hoog_v2000		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/meergezinspand_hoog_v2000[nrAsl];
			attribute<nrAsl> 	meergezinspand_hoog_v2006		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/meergezinspand_hoog_v2006[nrAsl];
			attribute<nrAsl> 	meergezinspand_hoog_v2011		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/meergezinspand_hoog_v2011[nrAsl];
			attribute<nrAsl> 	meergezinspand_hoog_v2014		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/meergezinspand_hoog_v2014[nrAsl];
			attribute<nrAsl> 	meergezinspand_hoog_v2020		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_bouwjaarklasse/meergezinspand_hoog_v2020[nrAsl];
			
			attribute<nrAsl> 	vrijstaand_A		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_energielabel/vrijstaand_A[nrAsl];
			attribute<nrAsl> 	vrijstaand_B		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_energielabel/vrijstaand_B[nrAsl];
			attribute<nrAsl> 	vrijstaand_C		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_energielabel/vrijstaand_C[nrAsl];
			attribute<nrAsl> 	vrijstaand_D		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_energielabel/vrijstaand_D[nrAsl];
			attribute<nrAsl> 	vrijstaand_E		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_energielabel/vrijstaand_E[nrAsl];
			attribute<nrAsl> 	vrijstaand_F		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_energielabel/vrijstaand_F[nrAsl];
			attribute<nrAsl> 	vrijstaand_G		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_energielabel/vrijstaand_G[nrAsl];
			attribute<nrAsl> 	vrijstaand_N		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_energielabel/vrijstaand_N[nrAsl];

			attribute<nrAsl> 	twee_onder_1_kap_A		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_energielabel/twee_onder_1_kap_A[nrAsl];
			attribute<nrAsl> 	twee_onder_1_kap_B		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_energielabel/twee_onder_1_kap_B[nrAsl];
			attribute<nrAsl> 	twee_onder_1_kap_C		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_energielabel/twee_onder_1_kap_C[nrAsl];
			attribute<nrAsl> 	twee_onder_1_kap_D		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_energielabel/twee_onder_1_kap_D[nrAsl];
			attribute<nrAsl> 	twee_onder_1_kap_E		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_energielabel/twee_onder_1_kap_E[nrAsl];
			attribute<nrAsl> 	twee_onder_1_kap_F		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_energielabel/twee_onder_1_kap_F[nrAsl];
			attribute<nrAsl> 	twee_onder_1_kap_G		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_energielabel/twee_onder_1_kap_G[nrAsl];
			attribute<nrAsl> 	twee_onder_1_kap_N		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_energielabel/twee_onder_1_kap_N[nrAsl];

			attribute<nrAsl> 	hoekwoning_A		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_energielabel/hoekwoning_A[nrAsl];
			attribute<nrAsl> 	hoekwoning_B		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_energielabel/hoekwoning_B[nrAsl];
			attribute<nrAsl> 	hoekwoning_C		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_energielabel/hoekwoning_C[nrAsl];
			attribute<nrAsl> 	hoekwoning_D		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_energielabel/hoekwoning_D[nrAsl];
			attribute<nrAsl> 	hoekwoning_E		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_energielabel/hoekwoning_E[nrAsl];
			attribute<nrAsl> 	hoekwoning_F		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_energielabel/hoekwoning_F[nrAsl];
			attribute<nrAsl> 	hoekwoning_G		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_energielabel/hoekwoning_G[nrAsl];
			attribute<nrAsl> 	hoekwoning_N		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_energielabel/hoekwoning_N[nrAsl];

			attribute<nrAsl> 	tussenwoning_A		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_energielabel/tussenwoning_A[nrAsl];
			attribute<nrAsl> 	tussenwoning_B		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_energielabel/tussenwoning_B[nrAsl];
			attribute<nrAsl> 	tussenwoning_C		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_energielabel/tussenwoning_C[nrAsl];
			attribute<nrAsl> 	tussenwoning_D		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_energielabel/tussenwoning_D[nrAsl];
			attribute<nrAsl> 	tussenwoning_E		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_energielabel/tussenwoning_E[nrAsl];
			attribute<nrAsl> 	tussenwoning_F		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_energielabel/tussenwoning_F[nrAsl];
			attribute<nrAsl> 	tussenwoning_G		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_energielabel/tussenwoning_G[nrAsl];
			attribute<nrAsl> 	tussenwoning_N		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_energielabel/tussenwoning_N[nrAsl];

			attribute<nrAsl> 	meergezinspand_laag_midden_A		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_energielabel/meergezinspand_laag_midden_A[nrAsl];
			attribute<nrAsl> 	meergezinspand_laag_midden_B		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_energielabel/meergezinspand_laag_midden_B[nrAsl];
			attribute<nrAsl> 	meergezinspand_laag_midden_C		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_energielabel/meergezinspand_laag_midden_C[nrAsl];
			attribute<nrAsl> 	meergezinspand_laag_midden_D		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_energielabel/meergezinspand_laag_midden_D[nrAsl];
			attribute<nrAsl> 	meergezinspand_laag_midden_E		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_energielabel/meergezinspand_laag_midden_E[nrAsl];
			attribute<nrAsl> 	meergezinspand_laag_midden_F		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_energielabel/meergezinspand_laag_midden_F[nrAsl];
			attribute<nrAsl> 	meergezinspand_laag_midden_G		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_energielabel/meergezinspand_laag_midden_G[nrAsl];
			attribute<nrAsl> 	meergezinspand_laag_midden_N		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_energielabel/meergezinspand_laag_midden_N[nrAsl];

			attribute<nrAsl> 	meergezinspand_hoog_A		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_energielabel/meergezinspand_hoog_A[nrAsl];
			attribute<nrAsl> 	meergezinspand_hoog_B		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_energielabel/meergezinspand_hoog_B[nrAsl];
			attribute<nrAsl> 	meergezinspand_hoog_C		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_energielabel/meergezinspand_hoog_C[nrAsl];
			attribute<nrAsl> 	meergezinspand_hoog_D		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_energielabel/meergezinspand_hoog_D[nrAsl];
			attribute<nrAsl> 	meergezinspand_hoog_E		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_energielabel/meergezinspand_hoog_E[nrAsl];
			attribute<nrAsl> 	meergezinspand_hoog_F		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_energielabel/meergezinspand_hoog_F[nrAsl];
			attribute<nrAsl> 	meergezinspand_hoog_G		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_energielabel/meergezinspand_hoog_G[nrAsl];
			attribute<nrAsl> 	meergezinspand_hoog_N		:= IsUitgesloten ? 0[nrAsl] :  tellingen/woningtype_energielabel/meergezinspand_hoog_N[nrAsl];

			attribute<m2> 	Kantoor_v1920		:= IsUitgesloten ? 0[m2] :  tellingen/utiltype_bouwjaarklasse/Kantoor_v1920;
			attribute<m2> 	Kantoor_v1975		:= IsUitgesloten ? 0[m2] :   tellingen/utiltype_bouwjaarklasse/Kantoor_v1975;
			attribute<m2> 	Kantoor_v1990		:= IsUitgesloten ? 0[m2] :   tellingen/utiltype_bouwjaarklasse/Kantoor_v1990;
			attribute<m2> 	Kantoor_v1995		:= IsUitgesloten ? 0[m2] :   tellingen/utiltype_bouwjaarklasse/Kantoor_v1995;
			attribute<m2> 	Kantoor_n1995		:= IsUitgesloten ? 0[m2] :   tellingen/utiltype_bouwjaarklasse/Kantoor_n1995;
			
			attribute<m2> 	winkel_v1920		:= IsUitgesloten ? 0[m2] :   tellingen/utiltype_bouwjaarklasse/winkel_v1920;
			attribute<m2> 	winkel_v1975		:= IsUitgesloten ? 0[m2] :   tellingen/utiltype_bouwjaarklasse/winkel_v1975;
			attribute<m2> 	winkel_v1990		:= IsUitgesloten ? 0[m2] :   tellingen/utiltype_bouwjaarklasse/winkel_v1990;
			attribute<m2> 	winkel_v1995		:= IsUitgesloten ? 0[m2] :   tellingen/utiltype_bouwjaarklasse/winkel_v1995;
			attribute<m2> 	winkel_n1995		:= IsUitgesloten ? 0[m2] :   tellingen/utiltype_bouwjaarklasse/winkel_n1995;
			
			attribute<m2> 	Gezondheidszorg_v1920		:= IsUitgesloten ? 0[m2] :   tellingen/utiltype_bouwjaarklasse/Gezondheidszorg_v1920;
			attribute<m2> 	Gezondheidszorg_v1975		:= IsUitgesloten ? 0[m2] :   tellingen/utiltype_bouwjaarklasse/Gezondheidszorg_v1975;
			attribute<m2> 	Gezondheidszorg_v1990		:= IsUitgesloten ? 0[m2] :   tellingen/utiltype_bouwjaarklasse/Gezondheidszorg_v1990;
			attribute<m2> 	Gezondheidszorg_v1995		:= IsUitgesloten ? 0[m2] :   tellingen/utiltype_bouwjaarklasse/Gezondheidszorg_v1995;
			attribute<m2> 	Gezondheidszorg_n1995		:= IsUitgesloten ? 0[m2] :   tellingen/utiltype_bouwjaarklasse/Gezondheidszorg_n1995;
			
			attribute<m2> 	Logies_v1920		:= IsUitgesloten ? 0[m2] :   tellingen/utiltype_bouwjaarklasse/Logies_v1920;
			attribute<m2> 	Logies_v1975		:= IsUitgesloten ? 0[m2] :   tellingen/utiltype_bouwjaarklasse/Logies_v1975;
			attribute<m2> 	Logies_v1990		:= IsUitgesloten ? 0[m2] :   tellingen/utiltype_bouwjaarklasse/Logies_v1990;
			attribute<m2> 	Logies_v1995		:= IsUitgesloten ? 0[m2] :   tellingen/utiltype_bouwjaarklasse/Logies_v1995;
			attribute<m2> 	Logies_n1995		:= IsUitgesloten ? 0[m2] :   tellingen/utiltype_bouwjaarklasse/Logies_n1995;
			
			attribute<m2> 	Onderwijs_v1920		:= IsUitgesloten ? 0[m2] :   tellingen/utiltype_bouwjaarklasse/Onderwijs_v1920;
			attribute<m2> 	Onderwijs_v1975		:= IsUitgesloten ? 0[m2] :   tellingen/utiltype_bouwjaarklasse/Onderwijs_v1975;
			attribute<m2> 	Onderwijs_v1990		:= IsUitgesloten ? 0[m2] :   tellingen/utiltype_bouwjaarklasse/Onderwijs_v1990;
			attribute<m2> 	Onderwijs_v1995		:= IsUitgesloten ? 0[m2] :   tellingen/utiltype_bouwjaarklasse/Onderwijs_v1995;
			attribute<m2> 	Onderwijs_n1995		:= IsUitgesloten ? 0[m2] :   tellingen/utiltype_bouwjaarklasse/Onderwijs_n1995;
			
			attribute<m2> 	Industrie_v1920		:= IsUitgesloten ? 0[m2] :   tellingen/utiltype_bouwjaarklasse/Industrie_v1920;
			attribute<m2> 	Industrie_v1975		:= IsUitgesloten ? 0[m2] :   tellingen/utiltype_bouwjaarklasse/Industrie_v1975;
			attribute<m2> 	Industrie_v1990		:= IsUitgesloten ? 0[m2] :   tellingen/utiltype_bouwjaarklasse/Industrie_v1990;
			attribute<m2> 	Industrie_v1995		:= IsUitgesloten ? 0[m2] :   tellingen/utiltype_bouwjaarklasse/Industrie_v1995;
			attribute<m2> 	Industrie_n1995		:= IsUitgesloten ? 0[m2] :   tellingen/utiltype_bouwjaarklasse/Industrie_n1995;
						
			attribute<m2> 	Bijeenkomst_v1920		:= IsUitgesloten ? 0[m2] :   tellingen/utiltype_bouwjaarklasse/Bijeenkomst_v1920;
			attribute<m2> 	Bijeenkomst_v1975		:= IsUitgesloten ? 0[m2] :   tellingen/utiltype_bouwjaarklasse/Bijeenkomst_v1975;
			attribute<m2> 	Bijeenkomst_v1990		:= IsUitgesloten ? 0[m2] :   tellingen/utiltype_bouwjaarklasse/Bijeenkomst_v1990;
			attribute<m2> 	Bijeenkomst_v1995		:= IsUitgesloten ? 0[m2] :   tellingen/utiltype_bouwjaarklasse/Bijeenkomst_v1995;
			attribute<m2> 	Bijeenkomst_n1995		:= IsUitgesloten ? 0[m2] :   tellingen/utiltype_bouwjaarklasse/Bijeenkomst_n1995;
			
			attribute<m2> 	Sport_v1920		:= IsUitgesloten ? 0[m2] :   tellingen/utiltype_bouwjaarklasse/Sport_v1920;
			attribute<m2> 	Sport_v1975		:= IsUitgesloten ? 0[m2] :   tellingen/utiltype_bouwjaarklasse/Sport_v1975;
			attribute<m2> 	Sport_v1990		:= IsUitgesloten ? 0[m2] :   tellingen/utiltype_bouwjaarklasse/Sport_v1990;
			attribute<m2> 	Sport_v1995		:= IsUitgesloten ? 0[m2] :   tellingen/utiltype_bouwjaarklasse/Sport_v1995;
			attribute<m2> 	Sport_n1995		:= IsUitgesloten ? 0[m2] :   tellingen/utiltype_bouwjaarklasse/Sport_n1995;			
			
			attribute<m2> 	overige_gebruiks_v1920		:= IsUitgesloten ? 0[m2] :   tellingen/utiltype_bouwjaarklasse/overige_gebruiks_v1920;
			attribute<m2> 	overige_gebruiks_v1975		:= IsUitgesloten ? 0[m2] :   tellingen/utiltype_bouwjaarklasse/overige_gebruiks_v1975;
			attribute<m2> 	overige_gebruiks_v1990		:= IsUitgesloten ? 0[m2] :   tellingen/utiltype_bouwjaarklasse/overige_gebruiks_v1990;
			attribute<m2> 	overige_gebruiks_v1995		:= IsUitgesloten ? 0[m2] :   tellingen/utiltype_bouwjaarklasse/overige_gebruiks_v1995;
			attribute<m2> 	overige_gebruiks_n1995		:= IsUitgesloten ? 0[m2] :   tellingen/utiltype_bouwjaarklasse/overige_gebruiks_n1995;			
			
			attribute<m2> 	Cel_v1920		:= IsUitgesloten ? 0[m2] :   tellingen/utiltype_bouwjaarklasse/Cel_v1920;
			attribute<m2> 	Cel_v1975		:= IsUitgesloten ? 0[m2] :   tellingen/utiltype_bouwjaarklasse/Cel_v1975;
			attribute<m2> 	Cel_v1990		:= IsUitgesloten ? 0[m2] :   tellingen/utiltype_bouwjaarklasse/Cel_v1990;
			attribute<m2> 	Cel_v1995		:= IsUitgesloten ? 0[m2] :   tellingen/utiltype_bouwjaarklasse/Cel_v1995;
			attribute<m2> 	Cel_n1995		:= IsUitgesloten ? 0[m2] :   tellingen/utiltype_bouwjaarklasse/Cel_n1995;
		}

		unit<uint32> variable := SubItem_PropValues(Table,'name');
		
		container export_csv_nl := Rapportage/WriteTable32ToCSV(Table, AsList(variable/name, ';'), FolderInfo/OutputFolder + '/gebouwvoorraad_export.csv');

	}

	attribute<bool> IsUitgesloten_Stap0_Referentie (PlanRegio) := Statisch/IsUitgesloten || IsStap0 || IsReferentie;

	#include <Freqentieverdeling_labels.dms>

	//dynamische indicatoren op hoofdlijnen
	container Hoofdindicatoren
	{

		unit<uint32> extensief := Invoer/DefaultInstellingen/Basis/PlanRegio
		{
			attribute<bool> IsOngeldig := Hulpvariabelen/Checks/s3GeenLT || Hulpvariabelen/Checks/s2GeenMT ||
				(Hulpvariabelen/Checks/NegatiefCO2 && not(IsUitgesloten_Stap0_Referentie));

			// VRAAG
			attribute<GJ_yr> H01_Vraag_totaal := add(H02_Vraag_RV, H03_Vraag_TW, H04_Vraag_Vent, H05_Vraag_K, H06_Vraag_App);

			attribute<GJ_yr> H02_Vraag_RV := IsOngeldig
				? (0/0)[GJ_yr]
				: (Statisch/IsUitgesloten || nrWEQ == 0[nrWoning])
					? 0[GJ_yr]
					: MakeDefined(
						  sum(Allocatie/BestaandeWoning/BO/Functioneel/V_RV, bebouwing/BestaandeWoning/PlanRegio_rel)
						+ sum(Allocatie/BestaandeUtil/BO/Functioneel/V_RV  , bebouwing/BestaandeUtil/PlanRegio_rel)
						, 0[GJ_yr]);

			attribute<GJ_yr> H03_Vraag_TW := IsOngeldig
				? (0/0)[GJ_yr]
				: (Statisch/IsUitgesloten || nrWEQ == 0[nrWoning])
					? 0[GJ_yr]
					: MakeDefined(
						  sum(Allocatie/BestaandeWoning/BO/Functioneel/V_TW, bebouwing/BestaandeWoning/PlanRegio_rel)
						+ sum(Allocatie/BestaandeUtil/BO/Functioneel/V_TW  , bebouwing/BestaandeUtil/PlanRegio_rel)
						,0[GJ_yr]);

			attribute<GJ_yr> H04_Vraag_Vent := IsOngeldig
				? (0/0)[GJ_yr]
				: (Statisch/IsUitgesloten || nrWEQ == 0[nrWoning])
					? 0[GJ_yr]
					: MakeDefined(
						  sum(Allocatie/BestaandeWoning/BO/Functioneel/V_Vent, bebouwing/BestaandeWoning/PlanRegio_rel)
						+ sum(Allocatie/BestaandeUtil/BO/Functioneel/V_Vent  , bebouwing/BestaandeUtil/PlanRegio_rel)
						,0[GJ_yr]);

			attribute<GJ_yr> H05_Vraag_K := IsOngeldig
				? (0/0)[GJ_yr]
				: (Statisch/IsUitgesloten || nrWEQ == 0[nrWoning])
					? 0[GJ_yr]
					: MakeDefined(
						  sum(Allocatie/BestaandeWoning/BO/Functioneel/V_K, bebouwing/BestaandeWoning/PlanRegio_rel)
						+ sum(Allocatie/BestaandeUtil/BO/Functioneel/V_K  , bebouwing/BestaandeUtil/PlanRegio_rel)
						,0[GJ_yr]);

			attribute<GJ_yr> H06_Vraag_App := IsOngeldig 
				? (0/0)[GJ_yr]
				: (Statisch/IsUitgesloten || nrWEQ == 0[nrWoning])
					? 0[GJ_yr]
					: MakeDefined(
						  sum(Allocatie/BestaandeWoning/BO/Functioneel/V_App, bebouwing/BestaandeWoning/PlanRegio_rel)
						+ sum(Allocatie/BestaandeUtil/BO/Functioneel/V_App  , bebouwing/BestaandeUtil/PlanRegio_rel)
						,0[GJ_yr]);

			// INPUTS
			attribute<GJ_yr> H08_Input_totaal := H09_Input_aardgas + H10_Input_KlimaatneutraalGas + H11_Input_elektriciteit + H12_input_MTwarmtebronnen + H13_input_LTwarmtebronnen + H14_Saldo_Omgevingswarmte;

			attribute<GJ_yr> H09_Input_aardgas := IsOngeldig
				? (0/0)[GJ_yr]
				: (Statisch/IsUitgesloten || nrWEQ == 0[nrWoning])
					? 0[GJ_yr]
					: MakeDefined(
						  R_AardG * sum(Allocatie/BestaandeWoning/metervraag/Aardgas, bebouwing/BestaandeWoning/PlanRegio_rel)
						+ R_AardG * sum(Allocatie/BestaandeUtil/metervraag/Aardgas  , bebouwing/BestaandeUtil/PlanRegio_rel)
						+ R_AardG * StateNaAllocatie/totaal/verbruik/V_id_gas
						+ R_AardG * StateNaAllocatie/totaal/verbruik/V_wd_gas
						+ R_AardG * StateNaAllocatie/totaal/verbruik/V_ow_gas
						+ WarmteBestaand/V_Bijstook
					 ,0[GJ_yr]) * (1.0 - KlimaatneutraalGasFactor);

			attribute<GJ_yr> H10_Input_KlimaatneutraalGas := IsOngeldig
				? (0/0)[GJ_yr]
				: (Statisch/IsUitgesloten || nrWEQ == 0[nrWoning])
					? 0[GJ_yr]
					: MakeDefined(
						  R_AardG * sum(Allocatie/BestaandeWoning/metervraag/Aardgas, bebouwing/BestaandeWoning/PlanRegio_rel)
						+ R_AardG * sum(Allocatie/BestaandeUtil/metervraag/Aardgas  , bebouwing/BestaandeUtil/PlanRegio_rel)
						+ R_AardG * StateNaAllocatie/totaal/verbruik/V_id_gas
						+ R_AardG * StateNaAllocatie/totaal/verbruik/V_wd_gas
						+ R_AardG * StateNaAllocatie/totaal/verbruik/V_ow_gas
						+ R_AardG * StateNaAllocatie/totaal/verbruik/V_H2
						+ WarmteBestaand/V_Bijstook
					 ,0[GJ_yr]) * KlimaatneutraalGasFactor;

			attribute<GJ_yr> H11_Input_elektriciteit := IsOngeldig
				? (0/0)[GJ_yr]
				: (Statisch/IsUitgesloten || nrWEQ == 0[nrWoning])
					? 0[GJ_yr]
					: MakeDefined(
						  R_AardG * sum(Allocatie/BestaandeWoning/metervraag/Elektriciteit, bebouwing/BestaandeWoning/PlanRegio_rel)
						+ R_AardG * sum(Allocatie/BestaandeUtil/metervraag/Elektriciteit, bebouwing/BestaandeUtil/PlanRegio_rel)
						+ R_AardG * StateNaAllocatie/totaal/verbruik/V_id_elek
						+ R_AardG * StateNaAllocatie/totaal/verbruik/V_wd_elek
						+ R_AardG * StateNaAllocatie/totaal/verbruik/V_ow_elek
						+ WarmteBestaand/V_wd_elek
						+ WarmteBestaand/V_elek_w
						+ WarmteBestaand/V_elek_u
					 ,0[GJ_yr]);

			attribute<GJ_yr> H12_input_MTwarmtebronnen := IsOngeldig
				? (0/0)[GJ_yr]
				: (Statisch/IsUitgesloten || nrWEQ == 0[nrWoning])
					? 0[GJ_yr]
					: MakeDefined(
						(sum(Allocatie/BestaandeWoning/metervraag/Warmte_LT, bebouwing/BestaandeWoning/PlanRegio_rel) > 0[GJ_yr]
							? 0[GJ_yr]
							:
							  R_AardG * StateNaAllocatie/Totaal/Verbruik/V_warmte
							+ R_AardG * StateNaAllocatie/Totaal/Verbruik/V_wd_verlies
							- R_AardG * StateNaAllocatie/Totaal/Verbruik/V_wd_gas
							+ R_AardG * StateNaAllocatie/Totaal/Verbruik/V_pt_verlies)
							+ WarmteBestaand/V_ow_warmte
					 ,0[GJ_yr]);

			attribute<GJ_yr> H13_input_LTwarmtebronnen := IsOngeldig
				? (0/0)[GJ_yr]
				: (Statisch/IsUitgesloten || nrWEQ == 0[nrWoning])
					? 0[GJ_yr]
					: MakeDefined(
						sum(Allocatie/BestaandeWoning/metervraag/Warmte_LT, bebouwing/BestaandeWoning/PlanRegio_rel) > 0[GJ_yr]
							? R_AardG * StateNaAllocatie/Totaal/Verbruik/V_warmte 
							: 0[GJ_yr]
					 ,0[GJ_yr]);

			attribute<GJ_yr> H14_Saldo_Omgevingswarmte := IsOngeldig ? (0/0)[GJ_yr] :
				(Statisch/IsUitgesloten || nrWEQ == 0[nrWoning])
					? 0[GJ_yr]
					: MakeDefined(
						 H01_Vraag_totaal - H09_Input_aardgas - H10_Input_KlimaatneutraalGas - H11_Input_elektriciteit - H12_input_MTwarmtebronnen - H13_input_LTwarmtebronnen
						,0[GJ_yr]);

			attribute<Eur_yr> H16_Nat_meerkost := IsOngeldig ? (0/0)[Eur_yr] :
				(Statisch/IsUitgesloten || isStap0)
					? 0[Eur_yr]
					: MakeDefined(
						 NationaleKosten/TotaalUitstoot/Delta_nat_kosten //nationale meerkosten per woningequivalent
						,0[Eur_yr]);

			attribute<GJ_yr> H21_Input_elektriciteit_WD_OW := IsOngeldig
				? (0/0)[GJ_yr]
				: (Statisch/IsUitgesloten || nrWEQ == 0[nrWoning])
					? 0[GJ_yr]
					: MakeDefined(
						  R_AardG * StateNaAllocatie/totaal/verbruik/V_wd_elek
						+ R_AardG * StateNaAllocatie/totaal/verbruik/V_ow_elek
						+ WarmteBestaand/V_wd_elek
					 ,0[GJ_yr]);

			//=====================================================================================================================================================================
			// VRAAG
			attribute<GJ_yr> H22_Vraag_totaal_w := add(H23_Vraag_RV_w, H24_Vraag_TW_w, H25_Vraag_Vent_w, H26_Vraag_K_w, H27_Vraag_App_w);

			attribute<GJ_yr> H23_Vraag_RV_w := IsOngeldig
				? (0/0)[GJ_yr]
				: (Statisch/IsUitgesloten || nrWEQ == 0[nrWoning])
					? 0[GJ_yr]
					: MakeDefined(
						  sum(Allocatie/BestaandeWoning/BO/Functioneel/V_RV, bebouwing/BestaandeWoning/PlanRegio_rel)
						, 0[GJ_yr]);

			attribute<GJ_yr> H24_Vraag_TW_w := IsOngeldig
				? (0/0)[GJ_yr]
				: (Statisch/IsUitgesloten || nrWEQ == 0[nrWoning])
					? 0[GJ_yr]
					: MakeDefined(
						  sum(Allocatie/BestaandeWoning/BO/Functioneel/V_TW, bebouwing/BestaandeWoning/PlanRegio_rel)
						,0[GJ_yr]);

			attribute<GJ_yr> H25_Vraag_Vent_w := IsOngeldig
				? (0/0)[GJ_yr]
				: (Statisch/IsUitgesloten || nrWEQ == 0[nrWoning])
					? 0[GJ_yr]
					: MakeDefined(
						  sum(Allocatie/BestaandeWoning/BO/Functioneel/V_Vent, bebouwing/BestaandeWoning/PlanRegio_rel)
						,0[GJ_yr]);

			attribute<GJ_yr> H26_Vraag_K_w := IsOngeldig
				? (0/0)[GJ_yr]
				: (Statisch/IsUitgesloten || nrWEQ == 0[nrWoning])
					? 0[GJ_yr]
					: MakeDefined(
						  sum(Allocatie/BestaandeWoning/BO/Functioneel/V_K, bebouwing/BestaandeWoning/PlanRegio_rel)
						,0[GJ_yr]);

			attribute<GJ_yr> H27_Vraag_App_w := IsOngeldig 
				? (0/0)[GJ_yr]
				: (Statisch/IsUitgesloten || nrWEQ == 0[nrWoning])
					? 0[GJ_yr]
					: MakeDefined(
						  sum(Allocatie/BestaandeWoning/BO/Functioneel/V_App, bebouwing/BestaandeWoning/PlanRegio_rel)
						,0[GJ_yr]);

			attribute<GJ_yr> H28_Vraag_totaal_u := add(H29_Vraag_RV_u, H30_Vraag_TW_u, H31_Vraag_Vent_u, H32_Vraag_K_u, H33_Vraag_App_u);

			attribute<GJ_yr> H29_Vraag_RV_u := IsOngeldig
				? (0/0)[GJ_yr]
				: (Statisch/IsUitgesloten || nrWEQ == 0[nrWoning])
					? 0[GJ_yr]
					: MakeDefined(
						  sum(Allocatie/BestaandeUtil/BO/Functioneel/V_RV, bebouwing/BestaandeUtil/PlanRegio_rel)
						, 0[GJ_yr]);

			attribute<GJ_yr> H30_Vraag_TW_u := IsOngeldig
				? (0/0)[GJ_yr]
				: (Statisch/IsUitgesloten || nrWEQ == 0[nrWoning])
					? 0[GJ_yr]
					: MakeDefined(
						  sum(Allocatie/BestaandeUtil/BO/Functioneel/V_TW, bebouwing/BestaandeUtil/PlanRegio_rel)
						,0[GJ_yr]);

			attribute<GJ_yr> H31_Vraag_Vent_u := IsOngeldig
				? (0/0)[GJ_yr]
				: (Statisch/IsUitgesloten || nrWEQ == 0[nrWoning])
					? 0[GJ_yr]
					: MakeDefined(
						  sum(Allocatie/BestaandeUtil/BO/Functioneel/V_Vent, bebouwing/BestaandeUtil/PlanRegio_rel)
						,0[GJ_yr]);

			attribute<GJ_yr> H32_Vraag_K_u := IsOngeldig
				? (0/0)[GJ_yr]
				: (Statisch/IsUitgesloten || nrWEQ == 0[nrWoning])
					? 0[GJ_yr]
					: MakeDefined(
						 sum(Allocatie/BestaandeUtil/BO/Functioneel/V_K, bebouwing/BestaandeUtil/PlanRegio_rel)
						,0[GJ_yr]);

			attribute<GJ_yr> H33_Vraag_App_u := IsOngeldig 
				? (0/0)[GJ_yr]
				: (Statisch/IsUitgesloten || nrWEQ == 0[nrWoning])
					? 0[GJ_yr]
					: MakeDefined(
						  sum(Allocatie/BestaandeUtil/BO/Functioneel/V_App, bebouwing/BestaandeUtil/PlanRegio_rel)
						,0[GJ_yr]);

			// INPUTS
			attribute<GJ_yr> H34_Input_totaal_w := H35_Input_aardgas_w + H36_Input_KlimaatneutraalGas_w + H37_Input_elektriciteit_w;

			attribute<GJ_yr> H35_Input_aardgas_w := IsOngeldig
				? (0/0)[GJ_yr]
				: (Statisch/IsUitgesloten || nrWEQ == 0[nrWoning])
					? 0[GJ_yr]
					: MakeDefined(
						  R_AardG * sum(Allocatie/BestaandeWoning/metervraag/Aardgas, bebouwing/BestaandeWoning/PlanRegio_rel)
					 ,0[GJ_yr]) * (1.0 - KlimaatneutraalGasFactor);

			attribute<GJ_yr> H36_Input_KlimaatneutraalGas_w := IsOngeldig
				? (0/0)[GJ_yr]
				: (Statisch/IsUitgesloten || nrWEQ == 0[nrWoning])
					? 0[GJ_yr]
					: MakeDefined(
						  R_AardG * sum(Allocatie/BestaandeWoning/metervraag/Aardgas, bebouwing/BestaandeWoning/PlanRegio_rel)
					 ,0[GJ_yr]) * KlimaatneutraalGasFactor;

			attribute<GJ_yr> H37_Input_elektriciteit_w := IsOngeldig
				? (0/0)[GJ_yr]
				: (Statisch/IsUitgesloten || nrWEQ == 0[nrWoning])
					? 0[GJ_yr]
					: MakeDefined(
						  R_AardG * sum(Allocatie/BestaandeWoning/metervraag/Elektriciteit, bebouwing/BestaandeWoning/PlanRegio_rel)
						+ WarmteBestaand/V_elek_w
					 ,0[GJ_yr]);

			attribute<GJ_yr> H38_Input_totaal_u := H39_Input_aardgas_u + H40_Input_KlimaatneutraalGas_u + H41_Input_elektriciteit_u;

			attribute<GJ_yr> H39_Input_aardgas_u := IsOngeldig
				? (0/0)[GJ_yr]
				: (Statisch/IsUitgesloten || nrWEQ == 0[nrWoning])
					? 0[GJ_yr]
					: MakeDefined(
						  R_AardG * sum(Allocatie/BestaandeUtil/metervraag/Aardgas, bebouwing/BestaandeUtil/PlanRegio_rel)
					 ,0[GJ_yr]) * (1.0 - KlimaatneutraalGasFactor);

			attribute<GJ_yr> H40_Input_KlimaatneutraalGas_u := IsOngeldig
				? (0/0)[GJ_yr]
				: (Statisch/IsUitgesloten || nrWEQ == 0[nrWoning])
					? 0[GJ_yr]
					: MakeDefined(
						  R_AardG * sum(Allocatie/BestaandeUtil/metervraag/Aardgas, bebouwing/BestaandeUtil/PlanRegio_rel)
					 ,0[GJ_yr]) * KlimaatneutraalGasFactor;

			attribute<GJ_yr> H41_Input_elektriciteit_u := IsOngeldig
				? (0/0)[GJ_yr]
				: (Statisch/IsUitgesloten || nrWEQ == 0[nrWoning])
					? 0[GJ_yr]
					: MakeDefined(
						  R_AardG * sum(Allocatie/BestaandeUtil/metervraag/Elektriciteit, bebouwing/BestaandeUtil/PlanRegio_rel)
						+ WarmteBestaand/V_elek_u
					 ,0[GJ_yr]);

			//=====================================================================================================================================================================
		}

		unit<uint32> table := extensief
		{
			attribute<string>    BU_CODE              := Statisch/table/I01_buurtcode;
			attribute<string>    V01_Strategievariant := const(Variantcode, Planregio);
			attribute<GJ_yr_WEQ> H01_vraag_totaal     := IsOngeldig ? (0/0)[GJ_yr_WEQ] : round(MakeDefined(extensief/H01_vraag_totaal  / nrWEQ, 0[GJ_yr_WEQ]))[GJ_yr_WEQ];
			attribute<GJ_yr_WEQ> H02_Vraag_RV         := IsOngeldig ? (0/0)[GJ_yr_WEQ] : round(MakeDefined(extensief/H02_Vraag_RV      / nrWEQ, 0[GJ_yr_WEQ]))[GJ_yr_WEQ];
			attribute<GJ_yr_WEQ> H03_Vraag_TW         := IsOngeldig ? (0/0)[GJ_yr_WEQ] : round(MakeDefined(extensief/H03_Vraag_TW      / nrWEQ, 0[GJ_yr_WEQ]))[GJ_yr_WEQ];
			attribute<GJ_yr_WEQ> H04_Vraag_Vent       := IsOngeldig ? (0/0)[GJ_yr_WEQ] : round(MakeDefined(extensief/H04_Vraag_Vent    / nrWEQ, 0[GJ_yr_WEQ]))[GJ_yr_WEQ];
			attribute<GJ_yr_WEQ> H05_Vraag_K          := IsOngeldig ? (0/0)[GJ_yr_WEQ] : round(MakeDefined(extensief/H05_Vraag_K       / nrWEQ, 0[GJ_yr_WEQ]))[GJ_yr_WEQ];
			attribute<GJ_yr_WEQ> H06_Vraag_App        := IsOngeldig ? (0/0)[GJ_yr_WEQ] : round(MakeDefined(extensief/H06_Vraag_App     / nrWEQ, 0[GJ_yr_WEQ]))[GJ_yr_WEQ];

			attribute<GJ_yr_ha>  H07_vraag_tot_ha := IsOngeldig
				? (0/0)[GJ_yr_ha]
				: round(
					(Statisch/IsUitgesloten || nrWEQ == 0[nrWoning])
						? 0[GJ_yr_ha]
						: MakeDefined(
							 (extensief/H02_Vraag_RV + extensief/H03_Vraag_TW) / Invoer/RuimtelijkeData/StudieGebied/buurt/Area_ov_r_land_com
							,0[GJ_yr_ha])
				)[GJ_yr_ha];

			attribute<GJ_yr_WEQ> H08_input_totaal          := IsOngeldig ? (0/0)[GJ_yr_WEQ] : round(MakeDefined(extensief/H08_input_totaal          / nrWEQ, 0[GJ_yr_WEQ]))[GJ_yr_WEQ];
			attribute<GJ_yr_WEQ> H09_input_aardgas         := IsOngeldig ? (0/0)[GJ_yr_WEQ] : round(MakeDefined(extensief/H09_input_aardgas         / nrWEQ, 0[GJ_yr_WEQ]))[GJ_yr_WEQ];
			attribute<GJ_yr_WEQ> H10_input_KlimaatneutraalGas     := IsOngeldig ? (0/0)[GJ_yr_WEQ] : round(MakeDefined(extensief/H10_input_KlimaatneutraalGas     / nrWEQ, 0[GJ_yr_WEQ]))[GJ_yr_WEQ];
			attribute<GJ_yr_WEQ> H11_input_elektriciteit   := IsOngeldig ? (0/0)[GJ_yr_WEQ] : round(MakeDefined(extensief/H11_input_elektriciteit   / nrWEQ, 0[GJ_yr_WEQ]))[GJ_yr_WEQ];
			attribute<GJ_yr_WEQ> H12_input_MTwarmtebronnen := IsOngeldig ? (0/0)[GJ_yr_WEQ] : round(MakeDefined(extensief/H12_input_MTwarmtebronnen / nrWEQ, 0[GJ_yr_WEQ]))[GJ_yr_WEQ];
			attribute<GJ_yr_WEQ> H13_input_LTwarmtebronnen := IsOngeldig ? (0/0)[GJ_yr_WEQ] : round(MakeDefined(extensief/H13_input_LTwarmtebronnen / nrWEQ, 0[GJ_yr_WEQ]))[GJ_yr_WEQ];
			attribute<GJ_yr_WEQ> H14_saldo_omgevingswarmte := IsOngeldig ? (0/0)[GJ_yr_WEQ] : round(MakeDefined(extensief/H14_saldo_omgevingswarmte / nrWEQ, 0[GJ_yr_WEQ]))[GJ_yr_WEQ];

			attribute<ton_yr> H15_CO2_uitstoot := IsOngeldig
				? (0/0)[ton_yr]
				: round(
					Statisch/IsUitgesloten
						? 0[ton_yr]
						: MakeDefined(
							NationaleKosten/TotaalUitstoot/New_CO2_ton
							,0[ton_yr])
				)[ton_yr];

			attribute<Eur_yr> H16_Nat_meerkost := IsOngeldig
				? (0/0)[Eur_yr]
				: round(
					(Statisch/IsUitgesloten || isReferentie)
						? 0[Eur_yr] 
						: MakeDefined(
							 NationaleKosten/TotaalUitstoot/Delta_nat_kosten //nationale meerkosten ten opzichte van startjaar
							,0[Eur_yr])
				)[Eur_yr];

			attribute<Eur_ton> H17_Nat_meerkost_CO2 := IsOngeldig
				? (0/0)[Eur_ton]
				: round(
					IsUitgesloten_Stap0_Referentie
						? 0[Eur_ton]
						: MakeDefined(
							 (NationaleKosten/TotaalUitstoot/Delta_nat_kosten / NationaleKosten/TotaalUitstoot/Delta_CO2) //nationale meerkosten per vermeden ton CO2
							,0[Eur_ton])
				)[Eur_ton];
			
			attribute<Eur_yr_WEQ> H18_Nat_meerkost_WEQ := IsOngeldig
				? (0/0)[Eur_yr_WEQ]
				: round(
					IsUitgesloten_Stap0_Referentie
						? 0[Eur_yr_WEQ]
						: MakeDefined(
							 (extensief/H16_Nat_meerkost / nrWEQ) //nationale meerkosten per vermeden ton CO2
							,0[Eur_yr_WEQ])
				)[Eur_yr_WEQ];

			attribute<Eur_m3> H19_Waarde_klimaatneutraal_gas          := const(0[Eur_m3] , PlanRegio);
			attribute<string> H20_Toekenning_klimaatneutraal_gas := const('onbekend', PlanRegio);

			attribute<GJ_yr_WEQ> H21_Input_elektriciteit_WD_OW     := IsOngeldig ? (0/0)[GJ_yr_WEQ] : round(MakeDefined(extensief/H21_Input_elektriciteit_WD_OW  / nrWEQ, 0[GJ_yr_WEQ]))[GJ_yr_WEQ];

			attribute<GJ_yr_WEQ> H22_vraag_totaal_w     := IsOngeldig ? (0/0)[GJ_yr_WEQ] : round(MakeDefined(extensief/H22_vraag_totaal_w  / nrWEQ, 0[GJ_yr_WEQ]))[GJ_yr_WEQ];
			attribute<GJ_yr_WEQ> H23_Vraag_RV_w         := IsOngeldig ? (0/0)[GJ_yr_WEQ] : round(MakeDefined(extensief/H23_Vraag_RV_w      / nrWEQ, 0[GJ_yr_WEQ]))[GJ_yr_WEQ];
			attribute<GJ_yr_WEQ> H24_Vraag_TW_w         := IsOngeldig ? (0/0)[GJ_yr_WEQ] : round(MakeDefined(extensief/H24_Vraag_TW_w      / nrWEQ, 0[GJ_yr_WEQ]))[GJ_yr_WEQ];
			attribute<GJ_yr_WEQ> H25_Vraag_Vent_w       := IsOngeldig ? (0/0)[GJ_yr_WEQ] : round(MakeDefined(extensief/H25_Vraag_Vent_w    / nrWEQ, 0[GJ_yr_WEQ]))[GJ_yr_WEQ];
			attribute<GJ_yr_WEQ> H26_Vraag_K_w          := IsOngeldig ? (0/0)[GJ_yr_WEQ] : round(MakeDefined(extensief/H26_Vraag_K_w       / nrWEQ, 0[GJ_yr_WEQ]))[GJ_yr_WEQ];
			attribute<GJ_yr_WEQ> H27_Vraag_App_w        := IsOngeldig ? (0/0)[GJ_yr_WEQ] : round(MakeDefined(extensief/H27_Vraag_App_w     / nrWEQ, 0[GJ_yr_WEQ]))[GJ_yr_WEQ];

			attribute<GJ_yr_WEQ> H28_vraag_totaal_u     := IsOngeldig ? (0/0)[GJ_yr_WEQ] : round(MakeDefined(extensief/H28_vraag_totaal_u  / nrWEQ, 0[GJ_yr_WEQ]))[GJ_yr_WEQ];
			attribute<GJ_yr_WEQ> H29_Vraag_RV_u         := IsOngeldig ? (0/0)[GJ_yr_WEQ] : round(MakeDefined(extensief/H29_Vraag_RV_u      / nrWEQ, 0[GJ_yr_WEQ]))[GJ_yr_WEQ];
			attribute<GJ_yr_WEQ> H30_Vraag_TW_u         := IsOngeldig ? (0/0)[GJ_yr_WEQ] : round(MakeDefined(extensief/H30_Vraag_TW_u      / nrWEQ, 0[GJ_yr_WEQ]))[GJ_yr_WEQ];
			attribute<GJ_yr_WEQ> H31_Vraag_Vent_u       := IsOngeldig ? (0/0)[GJ_yr_WEQ] : round(MakeDefined(extensief/H31_Vraag_Vent_u    / nrWEQ, 0[GJ_yr_WEQ]))[GJ_yr_WEQ];
			attribute<GJ_yr_WEQ> H32_Vraag_K_u          := IsOngeldig ? (0/0)[GJ_yr_WEQ] : round(MakeDefined(extensief/H32_Vraag_K_u       / nrWEQ, 0[GJ_yr_WEQ]))[GJ_yr_WEQ];
			attribute<GJ_yr_WEQ> H33_Vraag_App_u        := IsOngeldig ? (0/0)[GJ_yr_WEQ] : round(MakeDefined(extensief/H33_Vraag_App_u     / nrWEQ, 0[GJ_yr_WEQ]))[GJ_yr_WEQ];

			attribute<GJ_yr_WEQ> H34_input_totaal_w          := IsOngeldig ? (0/0)[GJ_yr_WEQ] : round(MakeDefined(extensief/H34_input_totaal_w          / nrWEQ, 0[GJ_yr_WEQ]))[GJ_yr_WEQ];
			attribute<GJ_yr_WEQ> H35_input_aardgas_w         := IsOngeldig ? (0/0)[GJ_yr_WEQ] : round(MakeDefined(extensief/H35_input_aardgas_w         / nrWEQ, 0[GJ_yr_WEQ]))[GJ_yr_WEQ];
			attribute<GJ_yr_WEQ> H36_input_KlimaatneutraalGas_w     := IsOngeldig ? (0/0)[GJ_yr_WEQ] : round(MakeDefined(extensief/H36_input_KlimaatneutraalGas_w     / nrWEQ, 0[GJ_yr_WEQ]))[GJ_yr_WEQ];
			attribute<GJ_yr_WEQ> H37_input_elektriciteit_w   := IsOngeldig ? (0/0)[GJ_yr_WEQ] : round(MakeDefined(extensief/H37_input_elektriciteit_w   / nrWEQ, 0[GJ_yr_WEQ]))[GJ_yr_WEQ];

			attribute<GJ_yr_WEQ> H38_input_totaal_u          := IsOngeldig ? (0/0)[GJ_yr_WEQ] : round(MakeDefined(extensief/H38_input_totaal_u          / nrWEQ, 0[GJ_yr_WEQ]))[GJ_yr_WEQ];
			attribute<GJ_yr_WEQ> H39_input_aardgas_u         := IsOngeldig ? (0/0)[GJ_yr_WEQ] : round(MakeDefined(extensief/H39_input_aardgas_u         / nrWEQ, 0[GJ_yr_WEQ]))[GJ_yr_WEQ];
			attribute<GJ_yr_WEQ> H40_input_KlimaatneutraalGas_u     := IsOngeldig ? (0/0)[GJ_yr_WEQ] : round(MakeDefined(extensief/H40_input_KlimaatneutraalGas_u     / nrWEQ, 0[GJ_yr_WEQ]))[GJ_yr_WEQ];
			attribute<GJ_yr_WEQ> H41_input_elektriciteit_u   := IsOngeldig ? (0/0)[GJ_yr_WEQ] : round(MakeDefined(extensief/H41_input_elektriciteit_u   / nrWEQ, 0[GJ_yr_WEQ]))[GJ_yr_WEQ];
		}

		parameter<string> RefExpr := isStap0 ? 'Ref_2023_' : isReferentie ? 'Ref_2030_' : '%configName%/';

		parameter<string> OutputFolder := '%localDataProjDir%/Results/' + Expand( . , RefExpr) + ''+ '';

		unit<uint32> variable := SubItem_PropValues(table, 'name');
		container export_csv := Rapportage/WriteTable32ToCSV(table, AsList(variable/name, ';'), OutputFolder + 'Hoofdindicatoren.csv');
	}

	//nationale kosten absoluut en CO2 uitstoot
	container NationaleKosten
	{
		attribute<bool> IsOngeldig                     (PlanRegio) := Hulpvariabelen/Checks/s3GeenLT || Hulpvariabelen/Checks/s2GeenMT;

		unit<uint32> Recap := Invoer/DefaultInstellingen/Basis/PlanRegio
		{
			attribute<Eur_yr> K09_Gebouw_installatie :=
				round(
					Statisch/IsUitgesloten
						? 0[Eur_yr]
						: MakeDefined(
							  R_AardG * Maatschappelijk/LokaleEnergieProductie/Kmi_30
							+ R_AardG * Maatschappelijk/LokaleEnergieProductie/Kmi_20 
							+ R_AardG * Maatschappelijk/LokaleEnergieProductie/Kmi_15 
							+ R_AardG * StateNaAllocatie/totaal/jaarlijks/id/Kmi_id_LO
							- Origkosten/table/K09_Gebouw_installatie
							,0[Eur_yr])
				)[Eur_yr];
		}
		unit<uint32> ExtraFactoren := Invoer/DefaultInstellingen/Basis/PlanRegio
		{
			parameter<Eur_asl> K_Koken             := not(isStap0 || isReferentie) ? 1000[Eur_asl] : 0.0[Eur_asl];
			attribute<Eur>     Ki_ElektrischKoken  := K_Koken * Statisch/Table/I09_aantal_woningen;
			attribute<Eur_yr>  Kmi_ElektrischKoken := Ki_ElektrischKoken * /TussenResultaten/StartJaar/NCW/mr15/AnnualisationFactor;
			
			parameter<ratio>   AandeelWP_NL        := sum(Aansluitingen/Table/A02_Aansl_eWP) / sum(Statisch/Table/I09_aantal_woningen + Statisch/Table/I10_aantal_utiliteit);
			parameter<Eur_kWh> OpslagWPverbruik    := 0.005[Eur_kWh] * AandeelWP_NL;
			parameter<Eur_GJ>  OpslagWP_GJ         := OpslagWPverbruik / 0.0036[GJ / kWh];
			attribute<Eur_yr>  Kj_OpslagWP         := Hoofdindicatoren/extensief/H11_Input_elektriciteit * OpslagWP_GJ;
			
		}
		
		unit<uint32> table := Invoer/DefaultInstellingen/Basis/PlanRegio
		{
			attribute<string> BU_CODE              := Statisch/table/I01_buurtcode;
			attribute<string> V01_Strategievariant := const(Variantcode, Planregio);

			attribute<Eur_yr> K01_Enet_verzwaren   := IsOngeldig
				? (0/0)[Eur_yr] 
				: round(
					IsUitgesloten_Stap0_Referentie
						? 0[Eur_yr]
						: MakeDefined(
							  R_AardG * Netwerken/Kosten/Ki_verzw_e_aansl        * NCW/mr50/AnnualisationFactor
							+ R_AardG * Netwerken/Kosten/cumulatief/Ki_verzw_MSR * NCW/mr50/AnnualisationFactor
							+ R_AardG * Netwerken/Kosten/cumulatief/Ki_verzw_LS  * NCW/mr50/AnnualisationFactor //jaarlijkse kapitaallasten verzwaren elektriciteits
							- Origkosten/table/K01_Enet_verzwaren
							,0[Eur_yr])
				  )[Eur_yr];

			attribute<Eur_yr> K02_Gnet_verwijderen := IsOngeldig
				? (0/0)[Eur_yr]
				: round(
					IsUitgesloten_Stap0_Referentie
						? 0[Eur_yr]
						: MakeDefined(
							  R_AardG * Netwerken/Aardgas/Kji_verwijderen //jaarlijkse kapitaallasten verwijderen gasnetten
							- Origkosten/table/K02_Gnet_verwijderen
							,0[Eur_yr])
				  )[Eur_yr];

			attribute<Eur_yr> K03_Gnet_aanpassen := IsOngeldig
				? (0/0)[Eur_yr]
				: round(
					IsUitgesloten_Stap0_Referentie
						? 0[Eur_yr]
						: MakeDefined(
							  R_AardG * StateNaAllocatie/totaal/jaarlijks/wd/Kmi_wd_Gnet //jaarlijkse kapitaallasten aanpassen gasnetten
							- Origkosten/table/K03_Gnet_aanpassen
							,0[Eur_yr])
				  )[Eur_yr];

			attribute<Eur_yr> K04_Wnet_buurt := IsOngeldig
				? (0/0)[Eur_yr]
				: round(
					IsUitgesloten_Stap0_Referentie
						? 0[Eur_yr]
						: MakeDefined(
							  R_AardG * StateNaAllocatie/totaal/jaarlijks/wd/Kmi_wd //jaarlijkse kapitaallasten wijkdistributie nieuwe warmtenetten
							- Origkosten/table/K04_Wnet_buurt
							,0[Eur_yr])
				  )[Eur_yr];
				
			attribute<Eur_yr> K05_Wnet_pand := IsOngeldig
				? (0/0)[Eur_yr]
				: round(
					IsUitgesloten_Stap0_Referentie
						? 0[Eur_yr]
						: MakeDefined(
							  R_AardG * StateNaAllocatie/totaal/jaarlijks/id/Kmi_id    //jaarlijkse kapitaallasten inpandig nieuwe warmtenetten
							+ R_AardG * StateNaAllocatie/totaal/jaarlijks/ge/Kmi_ge_ov //jaarlijkse kapitaallasten ongeriefsvergoeding nieuwe warmtenetten
							+ R_AardG * StateNaAllocatie/totaal/jaarlijks/ge/Kmi_ge_pm //jaarlijkse kapitaallasten projectmanagement nieuwe warmtenetten
							- Origkosten/table/K05_Wnet_pand
							,0[Eur_yr])
				  )[Eur_yr];

			attribute<Eur_yr> K06_Wnet_transport := IsOngeldig
				? (0/0)[Eur_yr]
				: round(
					IsUitgesloten_Stap0_Referentie
						? 0[Eur_yr]
						: MakeDefined(
							R_StadV > 0[ratio]
								? 0[Eur_yr]
								: R_AardG * StateNaAllocatie/totaal/jaarlijks/pt/Kmi_pt - Origkosten/table/K06_Wnet_transport //transportleidingen nieuwe warmtenetten
							,0[Eur_yr])
				  )[Eur_yr];

			attribute<Eur_yr> K07_Wnet_opwekking := IsOngeldig
				? (0/0)[Eur_yr]
				: round(
					IsUitgesloten_Stap0_Referentie
						? 0[Eur_yr]
						: MakeDefined(
							 R_AardG * StateNaAllocatie/totaal/jaarlijks/ow/Kmi_ow - Origkosten/table/K07_Wnet_opwekking    //realisatie bronnen nieuwe warmtenetten
							,0[Eur_yr])
				  )[Eur_yr];

			attribute<Eur_yr> K08_Gebouw_schil := IsOngeldig
				? (0/0)[Eur_yr]
				: round(
					IsUitgesloten_Stap0_Referentie
						? 0[Eur_yr] 
						: MakeDefined(
							 Maatschappelijk/gebouwen/Kmi_GebouwVerbetering - Origkosten/table/K08_Gebouw_schil          //kosten schilverbetering
							,0[Eur_yr])
				  )[Eur_yr];

			attribute<Eur_yr> K09_Gebouw_installatie := IsOngeldig
				? (0/0)[Eur_yr]
				: round(
					IsUitgesloten_Stap0_Referentie
						? 0[Eur_yr]
						: MakeDefined(
							  R_AardG * Maatschappelijk/LokaleEnergieProductie/Kmi_30
							+ R_AardG * Maatschappelijk/LokaleEnergieProductie/Kmi_20
							+ R_AardG * Maatschappelijk/LokaleEnergieProductie/Kmi_15
							+ R_AardG * Maatschappelijk/LokaleEnergieProductie/Kmi_LTAS
							+ R_AardG * StateNaAllocatie/totaal/jaarlijks/id/Kmi_id_LO
							- Origkosten/table/K09_Gebouw_installatie
							+ ExtraFactoren/Kmi_ElektrischKoken
							,0[Eur_yr])
				  )[Eur_yr];

			attribute<Eur_yr> K10_Totaal_Kapitaalslasten := IsOngeldig
				? (0/0)[Eur_yr]
				:
					  K01_Enet_verzwaren + K02_Gnet_verwijderen + K03_Gnet_aanpassen
					+ K04_Wnet_buurt     + K05_Wnet_pand        + K06_Wnet_transport + K07_Wnet_opwekking
					+ K08_Gebouw_schil   + K09_Gebouw_installatie;

			attribute<Eur_yr> K11_Inkoop_Warmte := IsOngeldig
				? (0/0)[Eur_yr]
				: round(
					Statisch/IsUitgesloten
						? 0[Eur_yr]
						: MakeDefined(
							 R_AardG * StateNaAllocatie/totaal/jaarlijks/ow/Kj_ow_productie + WarmteBestaand/Kj_ow_productie //productie warmte nieuwe warmtenetten
						   + R_AardG * StateNaAllocatie/totaal/jaarlijks/ow/Kj_winst 	    + WarmteBestaand/Kj_winst 		 //winst op kosten doorberekend in warmteprijs
							,0[Eur_yr])
				  )[Eur_yr];

			attribute<Eur_yr> K12_Inkoop_Gas := IsOngeldig
				? (0/0)[Eur_yr]
				: round(
					Statisch/IsUitgesloten
						? 0[Eur_yr] 
						: MakeDefined(
							  R_AardG * StateNaAllocatie/totaal/jaarlijks/ow/Km_ow_gas //kosten gas opwekking warmte nieuwe warmtenetten
							+ R_AardG * StateNaAllocatie/totaal/jaarlijks/wd/Km_wd_gas //kosten gas hulpketels in nieuwe warmtenetten
							+ R_AardG * StateNaAllocatie/totaal/jaarlijks/id/Km_id_gas //waterstof H2 opties
							+ WarmteBestaand/Kj_wd_gas
							+ R_AardG * Maatschappelijk/gebouwen/AardGasVerbruik/Km_Totaal
							+ R_AardG * Maatschappelijk/gebouwen/WaterstofVerbruik/Km_Totaal
							,0[Eur_yr])
				  )[Eur_yr];

			attribute<Eur_yr> K13_Inkoop_Elek := IsOngeldig
				? (0/0)[Eur_yr]
				: round(
					Statisch/IsUitgesloten
						? 0[Eur_yr]
						: MakeDefined(
							  R_AardG * StateNaAllocatie/totaal/jaarlijks/ow/Km_ow_elek    //elektriciteitskosten opwekking in nieuwe warmtenetten
							+ R_AardG * StateNaAllocatie/totaal/jaarlijks/id/Km_id_elek    //elektriciteitskosten inpandig in nieuwe warmtenetten
							+ R_AardG * StateNaAllocatie/totaal/jaarlijks/wd/Km_wd_elek    //elektriciteitskosten distributie in nieuwe warmtenetten
							+ R_AardG * StateNaAllocatie/totaal/jaarlijks/ge/Om_ge_comfort //jaarlijkse comfortwinst nieuwe warmtenetten
							+ WarmteBestaand/Kj_wd_elek
							+ R_AardG * Maatschappelijk/gebouwen/ElektriciteitsVraag/Km_Totaal
							+ WarmteBestaand/Kj_elek_gebouw
							+ ExtraFactoren/Kj_OpslagWP
							,0[Eur_yr])
				  )[Eur_yr];

			attribute<Eur_yr> K14_Gebouw_OenM := IsOngeldig
				? (0/0)[Eur_yr]
				: round(
					Statisch/IsUitgesloten
						? 0[Eur_yr]
						: MakeDefined(
							  R_AardG * Maatschappelijk/LokaleEnergieProductie/Kj_Onderhoud //onderhoud lodake opwekkingsinstallaties
							+ R_AardG * StateNaAllocatie/totaal/jaarlijks/id/Kj_id_LO_oh    //onderhoudskosten gebouwinstallaties gebiedsopties
							+ R_AardG * Maatschappelijk/LokaleEnergieProductie/Kj_Admin     //administratie lokale opwekkingsinstallaties
							,0[Eur_yr])
				  )[Eur_yr];

			attribute<Eur_yr> K15_Wnet_OenM := IsOngeldig
				? (0/0)[Eur_yr]
				: round(
					Statisch/IsUitgesloten
						? 0[Eur_yr]
						: MakeDefined(
							  R_AardG * StateNaAllocatie/totaal/jaarlijks/ow/Kj_ow_oh  //onderhoudskosten opwekking nieuwe warmtenetten
							+ R_AardG * StateNaAllocatie/totaal/jaarlijks/ow/Kj_ow_adm //administratiekosten opwekking nieuwe warmtenetten
							+ R_AardG * StateNaAllocatie/totaal/jaarlijks/pt/Kj_pt_oh  //onderhoudskosten transport nieuwe warmtenetten
							+ R_AardG * StateNaAllocatie/totaal/jaarlijks/pt/Kj_pt_adm //administratiekosten transport nieuwe warmtenetten
							+ R_AardG * StateNaAllocatie/totaal/jaarlijks/id/Kj_id_oh  //onderhoudskosten inpandig nieuwe warmtenetten
							+ R_AardG * StateNaAllocatie/totaal/jaarlijks/id/Kj_id_adm //administratiekosten inpandig nieuwe warmtenetten
							+ R_AardG * StateNaAllocatie/totaal/jaarlijks/wd/Kj_wd_oh  //onderhoudskosten distributie nieuwe warmtenetten
							+ R_AardG * StateNaAllocatie/totaal/jaarlijks/wd/Kj_wd_adm //administratiekosten distributie nieuwe warmtenetten
							+ R_AardG * StateNaAllocatie/totaal/jaarlijks/lv/Oj_lv_vastrecht * TussenResultaten/Leercurves/OenM/Curve * Kengetallen/Onderhoud/R_lv_Admin * 1[yr] //administratiekosten leverancier nieuwe warmtenetten
							+ WarmteBestaand/Kj_lv_admin + WarmteBestaand/Kj_id_oh  + WarmteBestaand/Kj_wd_oh + WarmteBestaand/Kj_wd_adm
							+ WarmteBestaand/Kj_pt_oh    + WarmteBestaand/Kj_pt_adm + WarmteBestaand/Kj_ow_oh + WarmteBestaand/Kj_ow_adm
							,0[Eur_yr])
				  )[Eur_yr];

			attribute<Eur_yr> K16_Enet_Gnet_OenM := IsOngeldig 
				? (0/0)[Eur_yr]
				: round(
					Statisch/IsUitgesloten
						? 0[Eur_yr]
						: MakeDefined(
							  R_AardG * Netwerken/Aardgas/Kj_oh //onderhoudskosten gasnet
							+ WarmteBestaand/Kj_gnet_oh
							+ R_AardG * Netwerken/Elektriciteit/Kj_oh	//onderhoudskosten elektriciteitsnet
							+ WarmteBestaand/Kj_enet_oh
							+ R_AardG * StateNaAllocatie/totaal/jaarlijks/wd/Kj_wd_Gnet_oh
							,0[Eur_yr])
				  )[Eur_yr];

			attribute<Eur_yr> K17_Totaal_VariabeleKosten := IsOngeldig
				? (0/0)[Eur_yr]
				: K11_Inkoop_Warmte + K12_Inkoop_Gas + K13_Inkoop_Elek + K14_Gebouw_OenM + K15_Wnet_OenM  + K16_Enet_Gnet_OenM;

			attribute<Eur_yr> K18_Extra_VariabeleKosten := IsOngeldig 
				? (0/0)[Eur_yr]
				: K17_Totaal_VariabeleKosten - Ref2030/PlanregioResults/NationaleKosten/Table/K17_Totaal_VariabeleKosten;

			attribute<Eur_yr> K19_Gebouw_schil_w := IsOngeldig
				? (0/0)[Eur_yr]
				: round(
					IsUitgesloten_Stap0_Referentie
						? 0[Eur_yr] 
						: MakeDefined(
							 Maatschappelijk/gebouwen/Kmi_GebouwVerbetering_w - Origkosten/table/K19_Gebouw_schil_w          //kosten schilverbetering
							,0[Eur_yr])
				  )[Eur_yr];

			attribute<Eur_yr> K20_Gebouw_installatie_w := IsOngeldig
				? (0/0)[Eur_yr]
				: round(
					IsUitgesloten_Stap0_Referentie
						? 0[Eur_yr]
						: MakeDefined(
							  R_AardG * Maatschappelijk/LokaleEnergieProductie/Kmi_30_w
							+ R_AardG * Maatschappelijk/LokaleEnergieProductie/Kmi_20_W
							+ R_AardG * Maatschappelijk/LokaleEnergieProductie/Kmi_15_W
							+ R_AardG * Maatschappelijk/LokaleEnergieProductie/Kmi_LTAS_w
							- Origkosten/table/K20_Gebouw_installatie_w
							+ ExtraFactoren/Kmi_ElektrischKoken
							,0[Eur_yr])
				  )[Eur_yr];

			attribute<Eur_yr> K21_Gebouw_schil_u := IsOngeldig
				? (0/0)[Eur_yr]
				: round(
					IsUitgesloten_Stap0_Referentie
						? 0[Eur_yr] 
						: MakeDefined(
							 Maatschappelijk/gebouwen/Kmi_GebouwVerbetering_u - Origkosten/table/K21_Gebouw_schil_u          //kosten schilverbetering
							,0[Eur_yr])
				  )[Eur_yr];

			attribute<Eur_yr> K22_Gebouw_installatie_u := IsOngeldig
				? (0/0)[Eur_yr]
				: round(
					IsUitgesloten_Stap0_Referentie
						? 0[Eur_yr]
						: MakeDefined(
							  R_AardG * Maatschappelijk/LokaleEnergieProductie/Kmi_30_u
							+ R_AardG * Maatschappelijk/LokaleEnergieProductie/Kmi_20_u
							+ R_AardG * Maatschappelijk/LokaleEnergieProductie/Kmi_15_u
							+ R_AardG * Maatschappelijk/LokaleEnergieProductie/Kmi_LTAS_u
							- Origkosten/table/K22_Gebouw_installatie_u
							,0[Eur_yr])
				  )[Eur_yr];
				  
			attribute<Eur_yr> K23_winst_warmtebedrijven := IsOngeldig
				? (0/0)[Eur_yr]
				: round(
					IsUitgesloten_Stap0_Referentie
						? 0[Eur_yr]
						: MakeDefined(
							  R_AardG * StateNaAllocatie/totaal/jaarlijks/ow/Kj_winst + WarmteBestaand/Kj_winst 		 //winst op kosten doorberekend in warmteprijs
							,0[Eur_yr])
				  )[Eur_yr];
		}

		parameter<string> RefExpr := isStap0 ? 'Ref_2023_' : isReferentie ? 'Ref_2030_' : '%configName%/';

		parameter<string> OutputFolder := '%localDataProjDir%/Results/' + Expand( . , RefExpr) + ''+ '';

		unit<uint32> variable := SubItem_PropValues(table,'name');
		container export_csv  := Rapportage/WriteTable32ToCSV(table, AsList(variable/name, ';'), OutputFolder+'NationaleKosten.csv');		

		container TotaalUitstoot
		{
			attribute<Eur_yr> Natkosten_abs (Planregio) :=
				  table/K01_Enet_verzwaren
				+ table/K02_Gnet_verwijderen
				+ table/K03_Gnet_aanpassen
				+ table/K04_Wnet_buurt
				+ table/K05_Wnet_pand
				+ table/K06_Wnet_transport
				+ table/K07_Wnet_opwekking
				+ table/K08_Gebouw_schil
				+ table/K09_Gebouw_installatie

				+ table/K17_Totaal_VariabeleKosten

				- Origkosten/table/K11_Inkoop_Warmte
				- Origkosten/table/K12_Inkoop_Gas
				- Origkosten/table/K13_Inkoop_Elek
				- Origkosten/table/K14_Gebouw_OenM
				- Origkosten/table/K15_Wnet_OenM
				- Origkosten/table/K16_Enet_Gnet_OenM;

			attribute<ton_yr> Orig_CO2_ton (Planregio) := OrigKosten/Orig_CO2_ton;

// 			attribute<ton_yr> New_CO2_ton_x  (Planregio) :=
//				(1.0 - KlimaatneutraalGasFactor) * (EnergyResults/CO2/gebouwen/Aardgas/totaal + EnergyResults/CO2/GebiedsOpties/totaal) / 1000[kg_yr / ton_yr];
			
			attribute<ton_yr> New_CO2_ton  (Planregio) :=
				(1.0 - KlimaatneutraalGasFactor) * (EnergyResults/CO2/gebouwen/Totaal_ex_app + EnergyResults/CO2/GebiedsOpties/totaal) / 1000[kg_yr / ton_yr];

			attribute<ton_yr> Delta_CO2        (Planregio) := Orig_CO2_ton - New_CO2_ton;
			attribute<Eur_yr> Delta_nat_kosten (Planregio) := Natkosten_abs;
		}
	}

	container Aansluitingen
	{
		unit<uint32> table := Invoer/DefaultInstellingen/Basis/PlanRegio
		{
			attribute<string>  BU_CODE              := Statisch/table/I01_buurtcode;
			attribute<string>  V01_Strategievariant := const(Variantcode, Planregio);

			attribute<nrAsl> A01_Aansl_aardgas :=
				round(
					(Statisch/IsUitgesloten)
						? 0[nrAsl]
						: MakeDefined(
							 R_AardG * Allocatie/aant_g_aansl_per_planregio
							,0[nrAsl]) * (1.0 - KlimaatneutraalGasFactor)
				)[nrAsl];

			attribute<nrAsl> A02_Aansl_eWP :=
				round(
					Statisch/IsUitgesloten
						? 0[nrAsl]
						: MakeDefined(
							   R_AardG * Allocatie/BestaandeWoning/Aansluitingen/Enet_ewp
							 + R_AardG * Allocatie/BestaandeUtil/Aansluitingen/Enet_ewp
							,0[nrAsl])
				)[nrAsl];

			attribute<nrAsl> A03_Aansl_MT :=
				round(
					Statisch/IsUitgesloten
						? 0[nrAsl]
						: MakeDefined(
							  R_AardG * StateNaAllocatie/nrAansluitinging/Restwarmte //nieuwe aansluitingen restwarmte
							+ R_AardG * StateNaAllocatie/nrAansluitinging/Geothermie //nieuwe aansluitingen geothermie
							+ R_AardG * StateNaAllocatie/nrAansluitinging/WijkWKK    //nieuwe aansluitingen wijkwkk
							+ R_AardG * StateNaAllocatie/nrAansluitinging/BioWKK     //nieuwe aansluitingen biowkk
							+ WarmteBestaand/nrAansl_w_MT
							+ WarmteBestaand/nrAansl_u_MT
							,0[nrAsl])
				)[nrAsl];

			attribute<nrAsl> A04_Aansl_LT :=
				round(
					Statisch/IsUitgesloten
						? 0[nrAsl]
						: MakeDefined(
							   R_AardG * StateNaAllocatie/nrAansluitinging/WKO15_15
							 + R_AardG * StateNaAllocatie/nrAansluitinging/WKO15_50
							 + R_AardG * StateNaAllocatie/nrAansluitinging/WKO15_70
							 + R_AardG * StateNaAllocatie/nrAansluitinging/LT15_15
							 + R_AardG * StateNaAllocatie/nrAansluitinging/LT15_50
							 + R_AardG * StateNaAllocatie/nrAansluitinging/LT15_70
							 + R_AardG * StateNaAllocatie/nrAansluitinging/LT30_30
							 + R_AardG * StateNaAllocatie/nrAansluitinging/LT30_50
							 + R_AardG * StateNaAllocatie/nrAansluitinging/LT30_70
							 + R_AardG * StateNaAllocatie/nrAansluitinging/TEO
							 + R_AardG * StateNaAllocatie/nrAansluitinging/BuurtWKO
							,0[nrAsl])
				)[nrAsl];

			attribute<nrAsl> A05_Aansl_hWP_HG :=
				round(
					Statisch/IsUitgesloten
							? 0[nrAsl]
							: MakeDefined(
								   R_AardG * Allocatie/BestaandeUtil/Aansluitingen/Enet_hwp
								 + R_AardG * Allocatie/BestaandeWoning/Aansluitingen/Enet_hwp
								,0[nrAsl])
				)[nrAsl];

			attribute<nrAsl> A06_Aansl_HR_HG :=
				round(
					(Statisch/IsUitgesloten)
							? 0[nrAsl]
							: MakeDefined(
								   R_AardG * sum(Allocatie/BestaandeUtil/BO/Aansluitingen/Gnet   * float64(Allocatie/BestaandeUtil/BO/Aansluitingen/Enet_hwp   == 0[nrAsl]), Allocatie/BestaandeUtil/BO/Planregio_rel)
								 + R_AardG * sum(Allocatie/BestaandeWoning/BO/Aansluitingen/Gnet * float64(Allocatie/BestaandeWoning/BO/Aansluitingen/Enet_hwp == 0[nrAsl]), Allocatie/BestaandeWoning/BO/Planregio_rel)
								 + R_AardG * StateNaAllocatie/nrAansluitinging/WaterstofHR
								,0[nrAsl]) * KlimaatneutraalGasFactor
				)[nrAsl];
				
			attribute<ratio> A07_Aandeel_eWP_WEQ :=
				round(
					Statisch/IsUitgesloten
						? 0[ratio]
						: MakeDefined(
							   (R_AardG * Allocatie/BestaandeWoning/Aansluitingen/Enet_ewp * 1[nrWoning / nrAsl]
							 + R_AardG * Allocatie/BestaandeUtil/Aansluitingen/Enet_ewp_weq) / nrWEQ * 100d
							,0[ratio])
				)[ratio] / 100d;
				
			attribute<ratio> A08_Aandeel_eWP_GJ :=
				round(
					Statisch/IsUitgesloten
						? 0[ratio]
						: MakeDefined(
							   (R_AardG * Allocatie/BestaandeWoning/Aansluitingen/Enet_ewp_GJ
							 + R_AardG * Allocatie/BestaandeUtil/Aansluitingen/Enet_ewp_GJ) / ((Hoofdindicatoren/Table/H02_Vraag_RV + Hoofdindicatoren/Table/H03_Vraag_TW) * nrWEQ) * 100d
							,0[ratio])
				)  [ratio] / 100d;
		}
		parameter<string> RefExpr := isStap0 ? 'Ref_2023_' : isReferentie ? 'Ref_2030_' : '%configName%/';

		parameter<string> OutputFolder := '%localDataProjDir%/Results/' + Expand( . , RefExpr) + ''+ '';

		unit<uint32> variable := SubItem_PropValues(table,'name');
		container export_csv  := Rapportage/WriteTable32ToCSV(table, AsList(variable/name, ';'), OutputFolder+'Aansluitingen.csv');
	}
}